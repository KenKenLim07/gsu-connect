import{j as e}from"./ui-L36-SHUh.js";import{u as T}from"./query-D6ti8Mjz.js";import{C as M,a as z,g as $}from"./newsService-C_6snLyb.js";import{a as x,L as I}from"./vendor-BMJYCA8e.js";import{b as E,c as R,d as A}from"./icons-WbXoxoGO.js";import{A as P,m as h}from"./animations-DicYFbWZ.js";import"./index-BSuhBg3O.js";import"./utils-DARsLm--.js";import"./index-BAYP90Ju.js";function N({news:s,variant:m,isImageLoaded:c=!1,showTitle:t=!0}){const[r,o]=x.useState(!c),l=()=>{o(!1)},d=()=>{switch(m){case"main":return"h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px]";case"other":return"h-[160px] sm:h-[200px] md:h-[240px] lg:h-[280px]";default:return"h-[180px]"}},v=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),y=p=>{s.source_url&&(p.preventDefault(),window.open(s.source_url,"_blank","noopener,noreferrer"))};return e.jsxs(I,{to:s.source_url?"#":`/news/${s.id}`,onClick:y,className:"block relative",children:[e.jsxs("div",{className:"relative",children:[r&&e.jsx("div",{className:`${d()} w-full bg-gray-100 animate-pulse`}),e.jsx("img",{src:s.image_url,alt:s.title,className:`${d()} w-full object-contain ${r?"hidden":"block"}`,onLoad:l})]}),t?e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-sm mt-1 space-y-0.5 p-1 md:p-[15px] text-center",children:[e.jsx("h3",{className:"text-[9px] sm:text-[10px] md:text-[10px] font-medium text-gray-900 line-clamp-2 px-1 w-full overflow-hidden",children:s.title}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-[6px] sm:text-[7px] md:text-[8px] text-gray-500 px-1 w-full",children:[e.jsx("span",{className:"truncate max-w-[60px] md:max-w-[70px]",children:s.source_url?new URL(s.source_url).hostname.replace("www.",""):"GSU"}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:v(s.published_at)})]})]}):e.jsx("div",{className:"h-[70px] sm:h-[80px]"})]})}const F=async s=>{const m={};return await Promise.all(s.map(async c=>{if(c.image_url)try{const t=new Image;await new Promise((o,l)=>{t.onload=o,t.onerror=l,t.src=c.image_url});const r=t.width/t.height;m[c.id]={width:t.width,height:t.height,isValid:r>=1&&r<=16/9,isLoading:!1}}catch(t){console.warn(`Failed to load image for news item ${c.id}:`,t),m[c.id]={width:0,height:0,isValid:!1,isLoading:!1}}})),m};function q({news:s,loading:m,error:c}){const[t,r]=x.useState(0),[o,l]=x.useState(0),[d,v]=x.useState(null),[y,p]=x.useState(null),f=x.useRef(void 0),{data:b={}}=T({queryKey:["mainCampusImageDimensions",s.map(a=>a.id).join(",")],queryFn:()=>F(s),enabled:s.length>0,staleTime:5*60*1e3,gcTime:30*60*1e3}),w=50,n=x.useMemo(()=>s.filter(a=>{const i=b[a.id];return a.image_url&&(i==null?void 0:i.isValid)&&!i.isLoading}).sort((a,i)=>new Date(i.created_at).getTime()-new Date(a.created_at).getTime()).slice(0,5),[s,b]),u=x.useCallback(()=>{f.current&&clearInterval(f.current),f.current=setInterval(()=>{l(1),r(a=>(a+1)%n.length)},3300)},[n.length]);x.useEffect(()=>(n.length>0&&u(),()=>{f.current&&clearInterval(f.current)}),[n.length,u]);const k=a=>{p(null),v(a.targetTouches[0].clientX),u()},S=a=>{const i=a.targetTouches[0].clientX,j=a.targetTouches[0].clientY;if(d&&Math.abs(i-d)>Math.abs(j-(d?a.targetTouches[0].clientY:0))&&a.preventDefault(),p(i),d){const g=d-i;Math.abs(g)>w&&l(g>0?1:-1)}},L=()=>{if(!d||!y)return;const a=d-y,i=a>w,j=a<-w;Math.abs(a)>w&&(i&&r(g=>(g+1)%n.length),j&&r(g=>(g-1+n.length)%n.length)),u()},_=()=>{l(-1),r(a=>(a-1+n.length)%n.length),u()},D=()=>{l(1),r(a=>(a+1)%n.length),u()};if(m&&(!s||s.length===0))return e.jsxs("div",{className:"relative min-h-[425px]",children:[e.jsxs("div",{className:"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible",children:[e.jsx("div",{className:"w-1/4 md:w-1/5 -mr-4 md:-mr-6",children:e.jsx("div",{className:"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg"})}),e.jsxs("div",{className:"w-2/3 md:w-3/4",children:[e.jsx("div",{className:"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg"}),e.jsxs("div",{className:"mt-2 space-y-1.5 p-1.5",children:[e.jsx("div",{className:"h-3 bg-gray-100 animate-pulse rounded w-3/4 mx-auto"}),e.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[e.jsx("div",{className:"h-2.5 bg-gray-100 animate-pulse rounded w-16"}),e.jsx("div",{className:"h-2.5 bg-gray-100 animate-pulse rounded w-2"}),e.jsx("div",{className:"h-2.5 bg-gray-100 animate-pulse rounded w-20"})]})]})]}),e.jsx("div",{className:"w-1/4 md:w-1/5 -ml-4 md:-ml-6",children:e.jsx("div",{className:"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg"})})]}),e.jsx("div",{className:"mt-4 text-center",children:[1,2,3,4,5].map((a,i)=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-gray-200 inline-block mx-1"},i))})]});if(c)return e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-red-600 mb-4",children:c}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Try Again"})]});if(n.length===0)return e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-gray-500",children:"No news available for Main Campus"})});const C=a=>(t+a+n.length)%n.length;return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"relative group",onTouchStart:k,onTouchMove:S,onTouchEnd:L,style:{touchAction:"pan-y pinch-zoom"},children:[e.jsx("button",{onClick:_,className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-lg hidden md:block opacity-0 md:group-hover:opacity-100 transition-opacity duration-200 hover:bg-white","aria-label":"Previous slide",children:e.jsx(E,{className:"w-6 h-6 text-gray-600"})}),e.jsx("button",{onClick:D,className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-lg hidden md:block opacity-0 md:group-hover:opacity-100 transition-opacity duration-200 hover:bg-white","aria-label":"Next slide",children:e.jsx(R,{className:"w-6 h-6 text-gray-600"})}),e.jsx("div",{className:"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible",children:e.jsxs(P,{mode:"popLayout",initial:!1,children:[e.jsx(h.div,{initial:{x:100,opacity:0,scale:.8,zIndex:1},animate:{x:0,opacity:.7,scale:1.5,zIndex:1,y:40,transition:{type:"spring",stiffness:200,damping:25,mass:.8,velocity:.5}},exit:{x:-100,opacity:0,scale:.8,transition:{type:"spring",stiffness:200,damping:25,mass:.8,velocity:.5}},className:"w-1/4 md:w-1/5 -mr-4 md:-mr-6",children:e.jsx(N,{news:n[C(-1)],variant:"main",showTitle:!1})},`prev-${t}`),e.jsx(h.div,{initial:{x:o*100,opacity:0,scale:.9,zIndex:2},animate:{x:0,opacity:1,scale:1.4,zIndex:2,transition:{type:"spring",stiffness:200,damping:25,mass:.8,velocity:.5}},exit:{x:-o*100,opacity:0,scale:.9,transition:{type:"spring",stiffness:200,damping:25,mass:.8,velocity:.5}},className:"w-2/3 md:w-3/4",children:e.jsx(N,{news:n[t],variant:"main",showTitle:!0})},`current-${t}`),e.jsx(h.div,{initial:{x:-100,opacity:0,scale:.8,zIndex:1},animate:{x:0,opacity:.7,scale:1.5,zIndex:1,y:40,transition:{type:"spring",stiffness:200,damping:25,mass:.8,velocity:.5}},exit:{x:100,opacity:0,scale:.8,transition:{type:"spring",stiffness:200,damping:25,mass:.8,velocity:.5}},className:"w-1/4 md:w-1/5 -ml-4 md:-ml-6",children:e.jsx(N,{news:n[C(1)],variant:"main",showTitle:!1})},`next-${t}`)]})}),n.length>0&&e.jsx("div",{className:"mt-4 text-center",children:n.map((a,i)=>e.jsxs(h.button,{onClick:()=>{l(i>t?1:-1),r(i),u()},className:"relative inline-block mx-1",whileHover:{scale:1.2},whileTap:{scale:.9},children:[e.jsx(h.div,{className:`w-1.5 h-1.5 rounded-full ${i===t?"bg-blue-600":"bg-gray-300"}`,animate:{scale:i===t?[1,1.8,1.4]:1,opacity:i===t?1:.5},transition:{duration:.4,ease:"easeInOut",times:[0,.5,1]}}),i===t&&e.jsx(h.div,{className:"absolute inset-0 rounded-full bg-blue-600/20",layoutId:"activeDot",transition:{type:"spring",stiffness:500,damping:30}})]},i))})]})})}function Q(){const{data:s=[],isLoading:m,error:c}=T({queryKey:["news"],queryFn:async()=>{const{data:o,error:l}=await $();if(l)throw new Error("Failed to load news");return o},staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1,retry:1}),t=s.filter(o=>{var l;return((l=o.campus)==null?void 0:l.name)==="Main Campus"}),r=c instanceof Error?c.message:null;return e.jsxs("div",{className:"flex flex-col min-h-screen bg-white",children:[e.jsx("section",{className:"relative py-16 px-4",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold tracking-tight text-gray-900 mb-4",children:"What's News"}),e.jsx(h.p,{className:"text-gray-600 text-base md:text-lg max-w-2xl mx-auto leading-relaxed",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},children:"Stay informed with the latest updates, events, and announcements from across our campuses"})]})})}),e.jsx("section",{className:"flex-1 overflow-y-auto px-4 py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-medium text-gray-700",children:"Main Campus News"}),e.jsx(I,{to:"/news?campus=Main%20Campus",children:e.jsx(M,{className:"hover:bg-gray-50 transition-colors border-gray-300",children:e.jsx(z,{className:"px-2 py-1",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-900",children:["Show all",e.jsx(A,{className:"w-3 h-3"})]})})})})]}),e.jsx(q,{news:t,loading:m,error:r})]})})})]})}export{Q as default};
//# sourceMappingURL=Home-BJuzlW8b.js.map
