{"version":3,"file":"Home-BsDfkkvM.js","sources":["../../src/components/news/NewsPreviewCard.tsx","../../src/components/news/MainCampusNews.tsx","../../src/components/news/CstNewsCard.tsx","../../src/components/news/CstNews.tsx","../../src/pages/Home.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport type { NewsItem } from \"@/types/news\";\n\ninterface NewsPreviewCardProps {\n  news: NewsItem;\n  variant: \"main\" | \"other\";\n  isImageLoaded?: boolean;\n  showTitle?: boolean;\n}\n\nexport default function NewsPreviewCard({ news, variant, isImageLoaded = false, showTitle = true }: NewsPreviewCardProps) {\n  const [imageLoading, setImageLoading] = useState(!isImageLoaded);\n\n  const handleImageLoad = () => {\n    setImageLoading(false);\n  };\n\n  const getImageHeight = () => {\n    switch (variant) {\n      case \"main\":\n        return \"h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px]\";\n      case \"other\":\n        return \"h-[160px] sm:h-[200px] md:h-[240px] lg:h-[280px]\";\n      default:\n        return \"h-[180px]\";\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n  });\n  };\n\n  const handleClick = (e: React.MouseEvent) => {\n    if (news.source_url) {\n      e.preventDefault();\n      window.open(news.source_url, '_blank', 'noopener,noreferrer');\n    }\n  };\n\n  return (\n    <Link \n      to={news.source_url ? '#' : `/news/${news.id}`}\n      onClick={handleClick}\n      className=\"block relative\"\n    >\n      <div className=\"relative\">\n        {imageLoading && (\n          <div className={`${getImageHeight()} w-full bg-gray-100 animate-pulse`} />\n        )}\n        <img\n          src={news.image_url}\n          alt={news.title}\n          className={`${getImageHeight()} w-full object-contain ${\n            imageLoading ? 'hidden' : 'block'\n          }`}\n          onLoad={handleImageLoad}\n        />\n      </div>\n      {showTitle ? (\n        <div className=\"absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-sm mt-1 space-y-0.5 p-1 md:p-[15px] text-center\">\n          <h3 className=\"text-[9px] sm:text-[10px] md:text-[10px] font-medium text-gray-900 line-clamp-2 px-1 w-full overflow-hidden\">\n            {news.title}\n          </h3>\n          <div className=\"flex items-center justify-center gap-1 text-[6px] sm:text-[7px] md:text-[8px] text-gray-500 px-1 w-full\">\n            <span className=\"truncate max-w-[60px] md:max-w-[70px]\">{news.source_url ? new URL(news.source_url).hostname.replace('www.', '') : 'GSU'}</span>\n            <span>•</span>\n            <span>{formatDate(news.published_at)}</span>\n        </div>\n        </div>\n      ) : (\n        <div className=\"h-[70px] sm:h-[80px]\" />\n      )}\n    </Link>\n  );\n} \n","import { useState, useCallback, useRef, useEffect, useMemo } from \"react\";\nimport type { NewsItem } from \"@/types/news\";\nimport NewsPreviewCard from \"./NewsPreviewCard\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface MainCampusNewsProps {\n  news: NewsItem[];\n  loading: boolean;\n  error: string | null;\n}\n\ninterface ImageDimensions {\n  [key: string]: {\n    width: number;\n    height: number;\n    isValid: boolean;\n    isLoading: boolean;\n  };\n}\n\n// Function to preload images and get dimensions\nconst preloadImages = async (news: NewsItem[]): Promise<ImageDimensions> => {\n  const dimensions: ImageDimensions = {};\n  \n  await Promise.all(\n    news.map(async (item) => {\n      if (!item.image_url) return;\n      \n      try {\n        const img = new Image();\n        await new Promise((resolve, reject) => {\n          img.onload = resolve;\n          img.onerror = reject;\n          img.src = item.image_url!;\n        });\n        \n        const aspectRatio = img.width / img.height;\n        dimensions[item.id] = {\n          width: img.width,\n          height: img.height,\n          isValid: aspectRatio >= 1 && aspectRatio <= 16/9,\n          isLoading: false\n        };\n      } catch (error) {\n        console.warn(`Failed to load image for news item ${item.id}:`, error);\n        dimensions[item.id] = {\n          width: 0,\n          height: 0,\n          isValid: false,\n          isLoading: false\n        };\n      }\n    })\n  );\n  \n  return dimensions;\n};\n\nexport default function MainCampusNews({ news, loading: parentLoading, error }: MainCampusNewsProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [direction, setDirection] = useState(0);\n  const [touchStart, setTouchStart] = useState<number | null>(null);\n  const [touchEnd, setTouchEnd] = useState<number | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | undefined>(undefined);\n\n  // Use React Query to cache image dimensions\n  const { data: imageDimensions = {} as ImageDimensions } = useQuery<ImageDimensions>({\n    queryKey: ['mainCampusImageDimensions', news.map(item => item.id).join(',')],\n    queryFn: () => preloadImages(news),\n    enabled: news.length > 0,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 30 * 60 * 1000, // 30 minutes\n  });\n\n  const minSwipeDistance = 50;\n\n  const filteredNews = useMemo(() => {\n    return news\n      .filter(item => {\n        const dimensions = imageDimensions[item.id];\n        return item.image_url && dimensions?.isValid && !dimensions.isLoading;\n      })\n      .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())\n      .slice(0, 5); // Limit to 5 items\n  }, [news, imageDimensions]);\n\n  const resetTimer = useCallback(() => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    timerRef.current = setInterval(() => {\n      setDirection(1);\n      setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredNews.length);\n    }, 3300);\n  }, [filteredNews.length]);\n\n  useEffect(() => {\n    if (filteredNews.length > 0) {\n      resetTimer();\n    }\n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    };\n  }, [filteredNews.length, resetTimer]);\n\n  const onTouchStart = (e: React.TouchEvent) => {\n    setTouchEnd(null);\n    setTouchStart(e.targetTouches[0].clientX);\n    resetTimer();\n  };\n\n  const onTouchMove = (e: React.TouchEvent) => {\n    const currentTouch = e.targetTouches[0].clientX;\n    const currentY = e.targetTouches[0].clientY;\n    \n    if (touchStart && Math.abs(currentTouch - touchStart) > Math.abs(currentY - (touchStart ? e.targetTouches[0].clientY : 0))) {\n      e.preventDefault();\n    }\n    \n    setTouchEnd(currentTouch);\n    \n    if (touchStart) {\n      const distance = touchStart - currentTouch;\n      if (Math.abs(distance) > minSwipeDistance) {\n        setDirection(distance > 0 ? 1 : -1);\n      }\n    }\n  };\n\n  const onTouchEnd = () => {\n    if (!touchStart || !touchEnd) return;\n    const distance = touchStart - touchEnd;\n    const isLeftSwipe = distance > minSwipeDistance;\n    const isRightSwipe = distance < -minSwipeDistance;\n\n    if (Math.abs(distance) > minSwipeDistance) {\n      if (isLeftSwipe) {\n        setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredNews.length);\n      }\n      if (isRightSwipe) {\n        setCurrentIndex((prevIndex) => (prevIndex - 1 + filteredNews.length) % filteredNews.length);\n      }\n    }\n    resetTimer();\n  };\n\n  const handlePrevious = () => {\n    setDirection(-1);\n    setCurrentIndex((prevIndex) => (prevIndex - 1 + filteredNews.length) % filteredNews.length);\n    resetTimer();\n  };\n\n  const handleNext = () => {\n    setDirection(1);\n    setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredNews.length);\n    resetTimer();\n  };\n\n  // Only show loading state on initial load\n  if (parentLoading && (!news || news.length === 0)) {\n    return (\n      <div className=\"relative min-h-[425px]\">\n        <div className=\"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible\">\n          {/* Previous Skeleton */}\n          <div className=\"w-1/4 md:w-1/5 -mr-4 md:-mr-6\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n          </div>\n\n          {/* Current Skeleton */}\n          <div className=\"w-2/3 md:w-3/4\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n            <div className=\"mt-2 space-y-1.5 p-1.5\">\n              <div className=\"h-3 bg-gray-100 animate-pulse rounded w-3/4 mx-auto\" />\n              <div className=\"flex items-center justify-center gap-1.5\">\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-16\" />\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-2\" />\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-20\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Next Skeleton */}\n          <div className=\"w-1/4 md:w-1/5 -ml-4 md:-ml-6\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n          </div>\n        </div>\n\n        {/* Skeleton Dots */}\n        <div className=\"mt-4 text-center\">\n          {[1, 2, 3, 4, 5].map((_, index) => (\n            <div\n              key={index}\n              className=\"w-1.5 h-1.5 rounded-full bg-gray-200 inline-block mx-1\"\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-6\">\n        <p className=\"text-red-600 mb-4\">{error}</p>\n        <button\n          onClick={() => window.location.reload()}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n        >\n          Try Again\n        </button>\n      </div>\n    );\n  }\n\n  if (filteredNews.length === 0) {\n    return (\n      <div className=\"text-center py-6\">\n        <p className=\"text-gray-500\">No news available for Main Campus</p>\n      </div>\n    );\n  }\n\n  const getAdjacentIndex = (offset: number) => {\n    return (currentIndex + offset + filteredNews.length) % filteredNews.length;\n  };\n\n  return (\n    <div className=\"w-full\">\n      <div \n        className=\"relative group\"\n        onTouchStart={onTouchStart}\n        onTouchMove={onTouchMove}\n        onTouchEnd={onTouchEnd}\n        style={{ touchAction: 'pan-y pinch-zoom' }}\n      >\n        <button\n          onClick={handlePrevious}\n          className=\"absolute left-2 top-1/2 -translate-y-1/2 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-lg hidden md:block opacity-0 md:group-hover:opacity-100 transition-opacity duration-200 hover:bg-white\"\n          aria-label=\"Previous slide\"\n        >\n          <ChevronLeft className=\"w-6 h-6 text-gray-600\" />\n        </button>\n\n        <button\n          onClick={handleNext}\n          className=\"absolute right-2 top-1/2 -translate-y-1/2 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-lg hidden md:block opacity-0 md:group-hover:opacity-100 transition-opacity duration-200 hover:bg-white\"\n          aria-label=\"Next slide\"\n        >\n          <ChevronRight className=\"w-6 h-6 text-gray-600\" />\n        </button>\n\n        <div className=\"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible\">\n          <AnimatePresence mode=\"popLayout\" initial={false}>\n            {/* Previous Image */}\n            <motion.div\n              key={`prev-${currentIndex}`}\n              initial={{ \n                x: 100,\n                opacity: 0,\n                scale: 0.8,\n                zIndex: 1\n              }}\n              animate={{ \n                x: 0,\n                opacity: 0.7,\n                scale: 1.5,\n                zIndex: 1,\n                y: 40,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              exit={{ \n                x: -100,\n                opacity: 0,\n                scale: 0.8,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              className=\"w-1/4 md:w-1/5 -mr-4 md:-mr-6\"\n            >\n              <NewsPreviewCard \n                news={filteredNews[getAdjacentIndex(-1)]} \n                variant=\"main\"\n                showTitle={false}\n              />\n            </motion.div>\n\n            {/* Current Image */}\n            <motion.div\n              key={`current-${currentIndex}`}\n              initial={{ \n                x: direction * 100,\n                opacity: 0,\n                scale: 0.9,\n                zIndex: 2\n              }}\n              animate={{ \n                x: 0,\n                opacity: 1,\n                scale: 1.4,\n                zIndex: 2,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              exit={{ \n                x: -direction * 100,\n                opacity: 0,\n                scale: 0.9,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              className=\"w-2/3 md:w-3/4\"\n            >\n              <NewsPreviewCard \n                news={filteredNews[currentIndex]} \n                variant=\"main\"\n                showTitle={true}\n              />\n            </motion.div>\n\n            {/* Next Image */}\n            <motion.div\n              key={`next-${currentIndex}`}\n              initial={{ \n                x: -100,\n                opacity: 0,\n                scale: 0.8,\n                zIndex: 1\n              }}\n              animate={{ \n                x: 0,\n                opacity: 0.7,\n                scale: 1.5,\n                zIndex: 1,\n                y: 40,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              exit={{ \n                x: 100,\n                opacity: 0,\n                scale: 0.8,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              className=\"w-1/4 md:w-1/5 -ml-4 md:-ml-6\"\n            >\n              <NewsPreviewCard \n                news={filteredNews[getAdjacentIndex(1)]} \n                variant=\"main\"\n                showTitle={false}\n              />\n            </motion.div>\n          </AnimatePresence>\n        </div>\n\n        {/* Dot indicators */}\n        {filteredNews.length > 0 && (\n          <div className=\"mt-4 text-center\">\n            {filteredNews.map((_, i) => (\n              <motion.button\n                key={i}\n                onClick={() => {\n                  setDirection(i > currentIndex ? 1 : -1);\n                  setCurrentIndex(i);\n                  resetTimer();\n                }}\n                className=\"relative inline-block mx-1\"\n                whileHover={{ scale: 1.2 }}\n                whileTap={{ scale: 0.9 }}\n              >\n                <motion.div\n                  className={`w-1.5 h-1.5 rounded-full ${\n                    i === currentIndex ? \"bg-blue-600\" : \"bg-gray-300\"\n                  }`}\n                  animate={{\n                    scale: i === currentIndex ? [1, 1.8, 1.4] : 1,\n                    opacity: i === currentIndex ? 1 : 0.5,\n                  }}\n                  transition={{\n                    duration: 0.4,\n                    ease: \"easeInOut\",\n                    times: [0, 0.5, 1],\n                  }}\n                />\n                {i === currentIndex && (\n                  <motion.div\n                    className=\"absolute inset-0 rounded-full bg-blue-600/20\"\n                    layoutId=\"activeDot\"\n                    transition={{\n                      type: \"spring\",\n                      stiffness: 500,\n                      damping: 30,\n                    }}\n                  />\n                )}\n              </motion.button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n} ","import { useState, useEffect, useRef } from \"react\";\nimport type { NewsItem } from \"../../types/news\";\n\ninterface CstNewsCardProps {\n  news: NewsItem;\n  isImageLoaded?: boolean;\n  index: number;\n  onImageLoaded: (index: number) => void;\n  canLoad: boolean;\n}\n\nexport default function CstNewsCard({ news, isImageLoaded = false, index, onImageLoaded, canLoad }: CstNewsCardProps) {\n  const [imageLoading, setImageLoading] = useState(!isImageLoaded);\n  const [isVisible, setIsVisible] = useState(false);\n  const [loadAttempted, setLoadAttempted] = useState(false);\n  const [retryCount, setRetryCount] = useState(0);\n  const [isMobile, setIsMobile] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n  const imageRef = useRef<HTMLImageElement>(null);\n  const retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Detect mobile device\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));\n    };\n    checkMobile();\n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // Start loading when canLoad becomes true\n  useEffect(() => {\n    if (canLoad && !isVisible) {\n      setIsVisible(true);\n      setLoadAttempted(true);\n    }\n  }, [canLoad, isVisible]);\n\n  // Setup intersection observer with mobile-specific settings\n  useEffect(() => {\n    observerRef.current = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting && canLoad) {\n            setIsVisible(true);\n            setLoadAttempted(true);\n          }\n        });\n      },\n      {\n        root: null,\n        rootMargin: isMobile ? '300px 0px' : '1500px 0px',\n        threshold: isMobile ? 0.1 : 0\n      }\n    );\n\n    if (containerRef.current) {\n      observerRef.current.observe(containerRef.current);\n    }\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, [canLoad, isMobile]);\n\n  // Force load after a delay if not loaded\n  useEffect(() => {\n    if (canLoad && !loadAttempted) {\n      const timer = setTimeout(() => {\n        if (!loadAttempted) {\n          setIsVisible(true);\n          setLoadAttempted(true);\n        }\n      }, isMobile ? 100 : 500);\n\n      return () => clearTimeout(timer);\n    }\n  }, [canLoad, loadAttempted, isMobile]);\n\n  // Cleanup retry timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (retryTimeoutRef.current) {\n        clearTimeout(retryTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const handleImageError = () => {\n    if (retryCount < 3) { // Reduced retry attempts\n      setRetryCount(prev => prev + 1);\n      setImageLoading(true);\n      \n      // Clear any existing retry timeout\n      if (retryTimeoutRef.current) {\n        clearTimeout(retryTimeoutRef.current);\n      }\n\n      // Force reload with exponential backoff\n      retryTimeoutRef.current = setTimeout(() => {\n        if (imageRef.current && news.image_url) {\n          const timestamp = Date.now();\n          const separator = news.image_url.includes('?') ? '&' : '?';\n          imageRef.current.src = `${news.image_url}${separator}t=${timestamp}`;\n        }\n      }, Math.min(1000 * Math.pow(2, retryCount), 5000)); // Exponential backoff with max 5s\n    } else {\n      // After max retries, show a fallback or error state\n      setImageLoading(false);\n      onImageLoaded(index);\n    }\n  };\n\n  const handleImageLoad = () => {\n    setImageLoading(false);\n    setLoadAttempted(true);\n    onImageLoaded(index);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n  };\n\n  const handleClick = () => {\n    if (news.source_url) {\n      window.open(news.source_url, '_blank', 'noopener,noreferrer');\n    }\n  };\n\n  return (\n    <div \n      onClick={handleClick}\n      className=\"block relative h-full cursor-pointer hover:opacity-90 transition-opacity\"\n      style={{ touchAction: 'pan-y pinch-zoom' }}\n    >\n      <div ref={containerRef} className=\"relative h-full overflow-hidden rounded-lg\">\n        {imageLoading && (\n          <div className=\"h-full w-full bg-gray-100 animate-pulse\" />\n        )}\n        {isVisible && (\n          <img\n            ref={imageRef}\n            src={news.image_url}\n            alt={news.title}\n            className={`h-[239%] w-full object-cover object-top ${\n              imageLoading ? 'hidden' : 'block'\n            }`}\n            onLoad={handleImageLoad}\n            onError={handleImageError}\n            loading={isMobile ? \"eager\" : \"lazy\"}\n            decoding={isMobile ? \"async\" : \"auto\"}\n          />\n        )}\n        <div className=\"absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-sm mt-1 space-y-1 p-1 text-center\">\n          <h3 className=\"text-xs font-medium text-gray-900 line-clamp-2\">\n            {news.title}\n          </h3>\n          <div className=\"flex items-center justify-center gap-1.5 text-[10px] text-gray-500\">\n            <span>{news.source_url ? new URL(news.source_url).hostname.replace('www.', '') : 'GSU'}</span>\n            <span>•</span>\n            <span>{formatDate(news.published_at)}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n} ","import { useState } from \"react\";\nimport type { NewsItem } from \"../../types/news\";\nimport CstNewsCard from \"./CstNewsCard\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface CstNewsProps {\n  news: NewsItem[];\n  loading: boolean;\n  error: string | null;\n}\n\n// Function to preload images\nconst preloadImages = async (news: NewsItem[]): Promise<Set<string>> => {\n  const preloadedUrls = new Set<string>();\n  \n  await Promise.all(\n    news\n      .filter((item: NewsItem) => item.image_url)\n      .map(async (item: NewsItem) => {\n        const url = item.image_url as string;\n        try {\n          const img = new Image();\n          await new Promise((resolve, reject) => {\n            img.onload = resolve;\n            img.onerror = reject;\n            img.src = url;\n          });\n          preloadedUrls.add(url);\n        } catch (error) {\n          console.warn(`Failed to preload image: ${url}`, error);\n        }\n      })\n  );\n  \n  return preloadedUrls;\n};\n\nexport default function CstNews({ news, loading, error }: CstNewsProps) {\n  const [loadedIndices, setLoadedIndices] = useState<Set<number>>(new Set());\n  const [nextToLoad, setNextToLoad] = useState(0);\n\n  // Use React Query to cache preloaded images\n  const { data: preloadedImages = new Set<string>() } = useQuery<Set<string>>({\n    queryKey: ['cstPreloadedImages', news.map(item => item.id).join(',')],\n    queryFn: () => preloadImages(news),\n    enabled: news.length > 0,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 30 * 60 * 1000, // 30 minutes\n  });\n\n  const handleImageLoaded = (index: number) => {\n    setLoadedIndices(prev => new Set([...prev, index]));\n    setNextToLoad(prev => prev + 1);\n  };\n\n  const checkImageLoaded = (news: NewsItem) => {\n    return news.image_url ? preloadedImages.has(news.image_url) : false;\n  };\n\n  const canLoadImage = (index: number) => {\n    return Math.abs(index - nextToLoad) <= 3 || loadedIndices.has(index - 1) || index < 4;\n  };\n\n  // Only show loading state on initial load\n  if (loading && (!news || news.length === 0)) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {[...Array(6)].map((_, index) => (\n          <div key={index} className=\"aspect-[4/3]\">\n            <div className=\"w-full h-full bg-white rounded-lg shadow-sm overflow-hidden\">\n              {/* Image skeleton */}\n              <div className=\"w-full h-[60%] bg-gray-100 animate-pulse\" />\n              \n              {/* Content skeleton */}\n              <div className=\"p-4 space-y-3\">\n                {/* Title skeleton */}\n                <div className=\"h-4 bg-gray-100 animate-pulse rounded w-3/4\" />\n                \n                {/* Date skeleton */}\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-24\" />\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-16\" />\n                </div>\n                \n                {/* Description skeleton */}\n                <div className=\"space-y-2\">\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-full\" />\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-5/6\" />\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-4/6\" />\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-red-500\">{error}</p>\n      </div>\n    );\n  }\n\n  if (!news || news.length === 0) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-gray-500\">No news available for CST</p>\n      </div>\n    );\n  }\n\n  // Sort news by published_at date and take only the 10 most recent\n  const recentNews = [...news]\n    .sort((a, b) => new Date(b.published_at).getTime() - new Date(a.published_at).getTime())\n    .slice(0, 10);\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n      {recentNews.map((item: NewsItem, index: number) => (\n        <div key={item.id} className=\"aspect-[4/3]\">\n          <CstNewsCard \n            news={item}\n            isImageLoaded={checkImageLoaded(item)}\n            index={index}\n            onImageLoaded={handleImageLoaded}\n            canLoad={canLoadImage(index)}\n          />\n        </div>\n      ))}\n    </div>\n  );\n} ","import { useQuery } from \"@tanstack/react-query\";\nimport { getNews } from \"@/services/newsService\";\nimport type { NewsItem } from \"@/types/news\";\nimport MainCampusNews from \"@/components/news/MainCampusNews\";\nimport CstNews from \"@/components/news/CstNews\";\nimport { motion } from \"framer-motion\";\nimport { Link } from \"react-router-dom\";\nimport { ArrowRight } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\nexport default function Home() {\n  const { data: news = [], isLoading, error } = useQuery<NewsItem[]>({\n    queryKey: ['news'],\n    queryFn: async () => {\n      const { data, error } = await getNews();\n      if (error) throw new Error('Failed to load news');\n      return data;\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 30 * 60 * 1000, // 30 minutes\n    refetchOnWindowFocus: false,\n    retry: 1,\n  });\n\n  const mainCampusNews = news.filter(item => item.campus?.name === \"Main Campus\");\n  const cstNews = news.filter(item => item.campus?.name === \"CST\");\n  const errorMessage = error instanceof Error ? error.message : null;\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-white\">\n      {/* Hero Section */}\n      <section className=\"relative py-16 px-4\">\n        <div className=\"max-w-5xl mx-auto\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"text-center\"\n          >\n            <h1 className=\"text-4xl md:text-5xl font-bold tracking-tight text-gray-900 mb-4\">\n              What's News\n            </h1>\n            <motion.p\n              className=\"text-gray-600 text-base md:text-lg max-w-2xl mx-auto leading-relaxed\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ duration: 0.5, delay: 0.2 }}\n            >\n              Stay informed with the latest updates, events, and announcements from across our campuses\n            </motion.p>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Content Section */}\n      <section className=\"flex-1 overflow-y-auto px-4 py-8\">\n        <div className=\"max-w-6xl mx-auto space-y-12\">\n          {/* Main Campus Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-base font-medium text-gray-700\">Main Campus News</h2>\n              <Link to=\"/news?campus=Main%20Campus\">\n                <Card className=\"hover:bg-gray-50 transition-colors border-gray-300\">\n                  <CardContent className=\"px-2 py-1\">\n                    <div className=\"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-900\">\n                      Show all\n                      <ArrowRight className=\"w-3 h-3\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </div>\n            <MainCampusNews news={mainCampusNews} loading={isLoading} error={errorMessage} />\n          </div>\n\n          <div className=\"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent\" />\n\n          {/* CST Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-base font-medium text-gray-700\">College of Science and Technology</h2>\n              <Link to=\"/news?campus=CST\">\n                <Card className=\"hover:bg-gray-50 transition-colors border-gray-300\">\n                  <CardContent className=\"px-2 py-1\">\n                    <div className=\"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-900\">\n                      Show all\n                      <ArrowRight className=\"w-3 h-3\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </div>\n            <CstNews news={cstNews} loading={isLoading} error={errorMessage} />\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n} \n"],"names":["NewsPreviewCard","news","variant","isImageLoaded","showTitle","imageLoading","setImageLoading","useState","handleImageLoad","getImageHeight","formatDate","dateString","handleClick","e","jsxs","Link","jsx","preloadImages","dimensions","item","img","resolve","reject","aspectRatio","error","MainCampusNews","parentLoading","currentIndex","setCurrentIndex","direction","setDirection","touchStart","setTouchStart","touchEnd","setTouchEnd","timerRef","useRef","imageDimensions","useQuery","minSwipeDistance","filteredNews","useMemo","a","b","resetTimer","useCallback","prevIndex","useEffect","onTouchStart","onTouchMove","currentTouch","currentY","distance","onTouchEnd","isLeftSwipe","isRightSwipe","handlePrevious","handleNext","_","index","getAdjacentIndex","offset","ChevronLeft","ChevronRight","AnimatePresence","motion","i","CstNewsCard","onImageLoaded","canLoad","isVisible","setIsVisible","loadAttempted","setLoadAttempted","retryCount","setRetryCount","isMobile","setIsMobile","containerRef","observerRef","imageRef","retryTimeoutRef","checkMobile","entries","entry","timer","handleImageError","prev","timestamp","separator","preloadedUrls","url","CstNews","loading","loadedIndices","setLoadedIndices","nextToLoad","setNextToLoad","preloadedImages","handleImageLoaded","checkImageLoaded","canLoadImage","recentNews","Home","isLoading","data","getNews","mainCampusNews","_a","cstNews","errorMessage","Card","CardContent","ArrowRight"],"mappings":"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"}