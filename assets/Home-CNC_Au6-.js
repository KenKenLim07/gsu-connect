import{j as e}from"./ui-L36-SHUh.js";import{u as E}from"./query-D6ti8Mjz.js";import{C as M,a as _,g as F}from"./newsService-C7GoRkAi.js";import{a as n,L}from"./vendor-BMJYCA8e.js";import{m as k}from"./animations-BCnMlSfH.js";import{b as T}from"./icons-CH71D4mC.js";import"./index-RtNNi-g1.js";import"./utils-DARsLm--.js";import"./index-BAYP90Ju.js";function A({news:a,loading:x,error:i}){const[g,o]=n.useState(null),m=a.filter(t=>t.image_url).sort((t,r)=>new Date(r.published_at).getTime()-new Date(t.published_at).getTime()).slice(0,3),d=t=>{const r=new Date(t),s=new Date,v=Math.abs(s.getTime()-r.getTime()),b=Math.ceil(v/(1e3*60*60*24));return b===1?"Today":b===2?"Yesterday":b<=7?`${b-1} days ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:r.getFullYear()!==s.getFullYear()?"numeric":void 0})},c=(t,r)=>{t.stopPropagation(),o(g===r?null:r)},y=(t,r)=>{t.stopPropagation(),r.source_url&&window.open(r.source_url,"_blank","noopener,noreferrer"),o(null)},p=async(t,r)=>{if(t.stopPropagation(),navigator.share)try{await navigator.share({title:r.title,text:r.content.substring(0,100),url:r.source_url||window.location.href})}catch{console.log("Share cancelled or failed")}else{const s=`${r.title}

${r.content.substring(0,100)}...

Read more: ${r.source_url||window.location.href}`;try{await navigator.clipboard.writeText(s),console.log("Content copied to clipboard")}catch{console.error("Failed to copy to clipboard")}}o(null)},u=()=>{o(null)};return x&&(!a||a.length===0)?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[...Array(3)].map((t,r)=>e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:r*.1},className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden",children:[e.jsx("div",{className:"h-40 bg-gray-100 dark:bg-gray-800 animate-pulse"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-1/2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-5/6"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-20"})})]})]},r))}):i?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-4 max-w-md mx-auto",children:[e.jsx("p",{className:"text-red-600 dark:text-red-200 font-medium mb-2",children:"Failed to load news"}),e.jsx("p",{className:"text-red-500 dark:text-red-300 text-sm mb-3",children:i}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-3 py-1.5 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 transition-colors text-sm",children:"Try Again"})]})}):m.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4 max-w-md mx-auto",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-300 font-medium",children:"No news available"}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-1",children:"Check back later for updates"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",onClick:u,children:m.map((t,r)=>e.jsxs(k.article,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:r*.1},className:"group bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden hover:shadow-md hover:border-gray-200 dark:hover:border-gray-700 transition-all duration-300",children:[e.jsxs("div",{className:"relative h-40 overflow-hidden",children:[e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 leading-tight line-clamp-2 text-sm flex-1",children:t.title}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:s=>c(s,r),className:"text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"})})}),g===r&&e.jsxs("div",{className:"absolute right-0 top-6 z-20 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg min-w-[140px]",children:[e.jsxs("button",{onClick:s=>y(s,t),className:"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Source"]}),e.jsxs("button",{onClick:s=>p(s,t),className:"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-t border-gray-100 dark:border-gray-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 leading-relaxed line-clamp-2",children:t.content.length>100?`${t.content.substring(0,100)}...`:t.content}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mt-2",children:[e.jsx("span",{children:t.source_url?new URL(t.source_url).hostname.replace("www.",""):"GSU"}),e.jsx("span",{children:d(t.published_at)})]})]})]},t.id))})}function U({news:a,isImageLoaded:x=!1,index:i,onImageLoaded:g,canLoad:o}){const[m,d]=n.useState(!x),[c,y]=n.useState(!1),[p,u]=n.useState(!1),[t,r]=n.useState(0),[s,v]=n.useState(!1),[b,w]=n.useState(!1),N=n.useRef(null),j=n.useRef(null),C=n.useRef(null),f=n.useRef(null),S=n.useRef(null);n.useEffect(()=>{const l=h=>{S.current&&!S.current.contains(h.target)&&w(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]),n.useEffect(()=>{const l=()=>{v(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent))};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),n.useEffect(()=>{o&&!c&&(y(!0),u(!0))},[o,c]),n.useEffect(()=>(j.current=new IntersectionObserver(l=>{l.forEach(h=>{h.isIntersecting&&o&&(y(!0),u(!0))})},{root:null,rootMargin:s?"300px 0px":"1500px 0px",threshold:s?.1:0}),N.current&&j.current.observe(N.current),()=>{j.current&&j.current.disconnect()}),[o,s]),n.useEffect(()=>{if(o&&!p){const l=setTimeout(()=>{p||(y(!0),u(!0))},s?100:500);return()=>clearTimeout(l)}},[o,p,s]),n.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]);const I=()=>{t<3?(r(l=>l+1),d(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{if(C.current&&a.image_url){const l=Date.now(),h=a.image_url.includes("?")?"&":"?";C.current.src=`${a.image_url}${h}t=${l}`}},Math.min(1e3*Math.pow(2,t),5e3))):(d(!1),g(i))},R=()=>{d(!1),u(!0),g(i)},z=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),$=l=>{l.stopPropagation(),w(!b)},D=l=>{l.stopPropagation(),a.source_url&&window.open(a.source_url,"_blank","noopener,noreferrer"),w(!1)},P=async l=>{if(l.stopPropagation(),navigator.share)try{await navigator.share({title:a.title,text:a.content.substring(0,100),url:a.source_url||window.location.href})}catch{console.log("Share cancelled or failed")}else{const h=`${a.title}

${a.content.substring(0,100)}...

Read more: ${a.source_url||window.location.href}`;try{await navigator.clipboard.writeText(h),console.log("Content copied to clipboard")}catch{console.error("Failed to copy to clipboard")}}w(!1)};return e.jsx("div",{className:"block relative h-full",style:{touchAction:"pan-y pinch-zoom"},children:e.jsx("div",{ref:N,className:"relative h-full overflow-hidden rounded-lg bg-white dark:bg-gray-900 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-[53%] h-full relative",children:[m&&e.jsx("div",{className:"w-full h-full bg-gray-100 dark:bg-gray-800 animate-pulse"}),c&&e.jsx("img",{ref:C,src:a.image_url,alt:a.title,className:`w-full h-full object-cover ${m?"hidden":"block"}`,onLoad:R,onError:I,loading:s?"eager":"lazy",decoding:s?"async":"auto"})]}),e.jsxs("div",{className:"w-[47%] h-full flex flex-col p-3",children:[e.jsxs("div",{className:"mb-1 flex justify-between items-center relative",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-300 underline underline-offset-2",children:"CST"}),e.jsxs("div",{ref:S,className:"relative",children:[e.jsx("button",{onClick:$,className:"text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"})})}),b&&e.jsxs("div",{className:"absolute right-0 top-6 z-20 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg min-w-[140px]",children:[e.jsxs("button",{onClick:D,className:"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Source"]}),e.jsxs("button",{onClick:P,className:"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-t border-gray-100 dark:border-gray-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share"]})]})]})]}),e.jsxs("div",{className:"flex-1 space-y-3 min-h-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 leading-tight line-clamp-3",children:a.title}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 leading-relaxed line-clamp-6",children:a.content.length>150?`${a.content.substring(0,150)}...`:a.content})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400 pt-2 border-t border-gray-100 dark:border-gray-800 flex-shrink-0",children:[e.jsx("span",{className:"truncate",children:a.source_url?new URL(a.source_url).hostname.replace("www.",""):"GSU"}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"whitespace-nowrap",children:z(a.published_at)})]})]})]})})})}const B=async a=>{const x=new Set;return await Promise.all(a.filter(i=>i.image_url).map(async i=>{const g=i.image_url;try{const o=new Image;await new Promise((m,d)=>{o.onload=m,o.onerror=d,o.src=g}),x.add(g)}catch(o){console.warn(`Failed to preload image: ${g}`,o)}})),x};function V({news:a,loading:x,error:i}){const[g,o]=n.useState(new Set),[m,d]=n.useState(0),{data:c=new Set}=E({queryKey:["cstPreloadedImages",a.map(r=>r.id).join(",")],queryFn:()=>B(a),enabled:a.length>0,staleTime:5*60*1e3,gcTime:30*60*1e3}),y=r=>{o(s=>new Set([...s,r])),d(s=>s+1)},p=r=>r.image_url?c.has(r.image_url):!1,u=r=>Math.abs(r-m)<=3||g.has(r-1)||r<4;if(x&&(!a||a.length===0))return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((r,s)=>e.jsx("div",{className:"aspect-[4/3]",children:e.jsxs("div",{className:"w-full h-full bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"w-full h-[60%] bg-gray-100 dark:bg-gray-800 animate-pulse"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-3/4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-24"}),e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-16"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-5/6"}),e.jsx("div",{className:"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-4/6"})]})]})]})},s))});if(i)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-red-500 dark:text-red-300",children:i})});if(!a||a.length===0)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-300",children:"No news available for CST"})});const t=[...a].sort((r,s)=>new Date(s.published_at).getTime()-new Date(r.published_at).getTime()).slice(0,10);return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((r,s)=>e.jsx("div",{className:"aspect-[4/3]",children:e.jsx(U,{news:r,isImageLoaded:p(r),index:s,onImageLoaded:y,canLoad:u(s)})},r.id))})}function Z(){const{data:a=[],isLoading:x,error:i}=E({queryKey:["news"],queryFn:async()=>{const{data:d,error:c}=await F();if(c)throw new Error("Failed to load news");return d},staleTime:3e5,gcTime:18e5,refetchOnWindowFocus:!1,retry:1}),g=a.filter(d=>{var c;return((c=d.campus)==null?void 0:c.name)==="Main Campus"}),o=a.filter(d=>{var c;return((c=d.campus)==null?void 0:c.name)==="CST"}),m=i instanceof Error?i.message:null;return e.jsxs("div",{className:"flex flex-col min-h-screen bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100",children:[e.jsx("section",{className:"relative py-16 px-4",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold tracking-tight text-gray-900 dark:text-gray-100 mb-4",children:"What's News"}),e.jsx(k.p,{className:"text-xs text-gray-600 dark:text-gray-300 max-w-2xl mx-auto leading-relaxed",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},children:"Stay connected. Stay informed"})]})})}),e.jsx("section",{className:"flex-1 overflow-y-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 border-b-2 border-black dark:border-gray-200 inline-block pb-1",children:"Salvador"}),e.jsx(L,{to:"/news?campus=Main%20Campus",children:e.jsx(M,{className:"hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors border-gray-300 dark:border-gray-700",children:e.jsx(_,{className:"px-2 py-1",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-black dark:text-gray-100 hover:text-gray-900 dark:hover:text-white",children:["Show all",e.jsx(T,{className:"w-3 h-3"})]})})})})]}),e.jsx(A,{news:g,loading:x,error:m})]}),e.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-200 dark:via-gray-700 to-transparent"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 border-b-2 border-black dark:border-gray-200 inline-block pb-1",children:"Mosqueda"}),e.jsx(L,{to:"/news?campus=CST",children:e.jsx(M,{className:"hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors border-gray-300 dark:border-gray-700",children:e.jsx(_,{className:"px-2 py-1",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-black dark:text-gray-100 hover:text-gray-900 dark:hover:text-white",children:["Show all",e.jsx(T,{className:"w-3 h-3"})]})})})})]}),e.jsx(V,{news:o,loading:x,error:m})]})]})})]})}export{Z as default};
//# sourceMappingURL=Home-CNC_Au6-.js.map
