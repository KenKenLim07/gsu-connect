{"version":3,"file":"Home-Df_m6mFb.js","sources":["../../src/components/news/NewsPreviewCard.tsx","../../src/components/news/MainCampusNews.tsx","../../src/components/news/CstNewsCard.tsx","../../src/components/news/CstNews.tsx","../../src/pages/Home.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport type { NewsItem } from \"@/types/news\";\n\ninterface NewsPreviewCardProps {\n  news: NewsItem;\n  variant: \"main\" | \"other\";\n  isImageLoaded?: boolean;\n  showTitle?: boolean;\n}\n\nexport default function NewsPreviewCard({ news, variant, isImageLoaded = false, showTitle = true }: NewsPreviewCardProps) {\n  const [imageLoading, setImageLoading] = useState(!isImageLoaded);\n\n  const handleImageLoad = () => {\n    setImageLoading(false);\n  };\n\n  const getImageHeight = () => {\n    switch (variant) {\n      case \"main\":\n        return \"h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px]\";\n      case \"other\":\n        return \"h-[160px] sm:h-[200px] md:h-[240px] lg:h-[280px]\";\n      default:\n        return \"h-[180px]\";\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n  });\n  };\n\n  const handleClick = (e: React.MouseEvent) => {\n    if (news.source_url) {\n      e.preventDefault();\n      window.open(news.source_url, '_blank', 'noopener,noreferrer');\n    }\n  };\n\n  return (\n    <Link \n      to={news.source_url ? '#' : `/news/${news.id}`}\n      onClick={handleClick}\n      className=\"block relative\"\n    >\n      <div className=\"relative\">\n        {imageLoading && (\n          <div className={`${getImageHeight()} w-full bg-gray-100 animate-pulse`} />\n        )}\n        <img\n          src={news.image_url}\n          alt={news.title}\n          className={`${getImageHeight()} w-full object-contain ${\n            imageLoading ? 'hidden' : 'block'\n          }`}\n          onLoad={handleImageLoad}\n        />\n      </div>\n      {showTitle ? (\n        <div className=\"absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-sm mt-1 space-y-0.5 p-1 md:p-[15px] text-center\">\n          <h3 className=\"text-[9px] sm:text-[10px] md:text-[10px] font-medium text-gray-900 line-clamp-2 px-1 w-full overflow-hidden\">\n            {news.title}\n          </h3>\n          <div className=\"flex items-center justify-center gap-1 text-[6px] sm:text-[7px] md:text-[8px] text-gray-500 px-1 w-full\">\n            <span className=\"truncate max-w-[60px] md:max-w-[70px]\">{news.source_url ? new URL(news.source_url).hostname.replace('www.', '') : 'GSU'}</span>\n            <span>•</span>\n            <span>{formatDate(news.published_at)}</span>\n        </div>\n        </div>\n      ) : (\n        <div className=\"h-[70px] sm:h-[80px]\" />\n      )}\n    </Link>\n  );\n} \n","import { useState, useCallback, useRef, useEffect } from \"react\";\nimport type { NewsItem } from \"@/types/news\";\nimport NewsPreviewCard from \"./NewsPreviewCard\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\n\ninterface MainCampusNewsProps {\n  news: NewsItem[];\n  loading: boolean;\n  error: string | null;\n}\n\n// Simple function to check if image has valid aspect ratio\nconst checkImageAspectRatio = (imageUrl: string): Promise<boolean> => {\n  return new Promise((resolve) => {\n    const img = new Image();\n    img.onload = () => {\n      const aspectRatio = img.width / img.height;\n      resolve(aspectRatio >= 1 && aspectRatio <= 16/9);\n    };\n    img.onerror = () => {\n      resolve(false);\n    };\n    img.src = imageUrl;\n  });\n};\n\nexport default function MainCampusNews({ news, loading: parentLoading, error }: MainCampusNewsProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [direction, setDirection] = useState(0);\n  const [touchStart, setTouchStart] = useState<number | null>(null);\n  const [touchEnd, setTouchEnd] = useState<number | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | undefined>(undefined);\n  const [validImages, setValidImages] = useState<Set<string>>(new Set());\n  const [isImageChecking, setIsImageChecking] = useState(false);\n\n  // Check image aspect ratios when news changes\n  useEffect(() => {\n    const checkImages = async () => {\n      if (news.length === 0) return;\n      \n      setIsImageChecking(true);\n      \n      const validUrls = new Set<string>();\n      \n      for (const item of news) {\n        if (item.image_url) {\n          const isValid = await checkImageAspectRatio(item.image_url);\n          if (isValid) {\n            validUrls.add(item.image_url);\n          }\n        }\n      }\n      \n      setValidImages(validUrls);\n      setIsImageChecking(false);\n    };\n\n    checkImages();\n  }, [news]);\n\n  // Filter news items with valid images\n  const filteredNews = news\n    .filter(item => item.image_url && validImages.has(item.image_url))\n    .sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())\n    .slice(0, 5);\n\n  const resetTimer = useCallback(() => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    // Disable auto-rotation to prevent white screen flash\n    // timerRef.current = setInterval(() => {\n    //   setDirection(1);\n    //   setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredNews.length);\n    // }, 3300);\n  }, [filteredNews.length]);\n\n  useEffect(() => {\n    // Disable auto-rotation timer setup\n    // if (filteredNews.length > 0) {\n    //   resetTimer();\n    // }\n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    };\n  }, [filteredNews.length, resetTimer]);\n\n  const onTouchStart = (e: React.TouchEvent) => {\n    setTouchEnd(null);\n    setTouchStart(e.targetTouches[0].clientX);\n    // resetTimer(); // Removed since timer is disabled\n  };\n\n  const onTouchMove = (e: React.TouchEvent) => {\n    const currentTouch = e.targetTouches[0].clientX;\n    setTouchEnd(currentTouch);\n  };\n\n  const onTouchEnd = () => {\n    if (!touchStart || !touchEnd) return;\n    const distance = touchStart - touchEnd;\n    const minSwipeDistance = 50;\n\n    if (Math.abs(distance) > minSwipeDistance) {\n      if (distance > 0) {\n        setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredNews.length);\n      } else {\n        setCurrentIndex((prevIndex) => (prevIndex - 1 + filteredNews.length) % filteredNews.length);\n      }\n    }\n    // resetTimer(); // Removed since timer is disabled\n  };\n\n  const handlePrevious = () => {\n    setDirection(-1);\n    setCurrentIndex((prevIndex) => (prevIndex - 1 + filteredNews.length) % filteredNews.length);\n    // resetTimer(); // Removed since timer is disabled\n  };\n\n  const handleNext = () => {\n    setDirection(1);\n    setCurrentIndex((prevIndex) => (prevIndex + 1) % filteredNews.length);\n    // resetTimer(); // Removed since timer is disabled\n  };\n\n  // Show loading state only when parent is loading and no news available\n  if (parentLoading && (!news || news.length === 0)) {\n    return (\n      <div className=\"relative min-h-[425px]\">\n        <div className=\"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible\">\n          {/* Previous Skeleton */}\n          <div className=\"w-1/4 md:w-1/5 -mr-4 md:-mr-6\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n          </div>\n\n          {/* Current Skeleton */}\n          <div className=\"w-2/3 md:w-3/4\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n            <div className=\"mt-2 space-y-1.5 p-1.5\">\n              <div className=\"h-3 bg-gray-100 animate-pulse rounded w-3/4 mx-auto\" />\n              <div className=\"flex items-center justify-center gap-1.5\">\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-16\" />\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-2\" />\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-20\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Next Skeleton */}\n          <div className=\"w-1/4 md:w-1/5 -ml-4 md:-ml-6\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n          </div>\n        </div>\n\n        {/* Skeleton Dots */}\n        <div className=\"mt-4 text-center\">\n          {[1, 2, 3, 4, 5].map((_, index) => (\n            <div\n              key={index}\n              className=\"w-1.5 h-1.5 rounded-full bg-gray-200 inline-block mx-1\"\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  // Show error state\n  if (error) {\n    return (\n      <div className=\"text-center py-6\">\n        <p className=\"text-red-600 mb-4\">{error}</p>\n        <button\n          onClick={() => window.location.reload()}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n        >\n          Try Again\n        </button>\n      </div>\n    );\n  }\n\n  // Show empty state - but only if we're not still checking images\n  if (filteredNews.length === 0 && !isImageChecking) {\n    return (\n      <div className=\"text-center py-6\">\n        <p className=\"text-gray-500\">No news available for Main Campus</p>\n      </div>\n    );\n  }\n\n  // Show loading while checking images\n  if (isImageChecking && filteredNews.length === 0) {\n    return (\n      <div className=\"relative min-h-[425px]\">\n        <div className=\"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible\">\n          {/* Previous Skeleton */}\n          <div className=\"w-1/4 md:w-1/5 -mr-4 md:-mr-6\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n          </div>\n\n          {/* Current Skeleton */}\n          <div className=\"w-2/3 md:w-3/4\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n            <div className=\"mt-2 space-y-1.5 p-1.5\">\n              <div className=\"h-3 bg-gray-100 animate-pulse rounded w-3/4 mx-auto\" />\n              <div className=\"flex items-center justify-center gap-1.5\">\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-16\" />\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-2\" />\n                <div className=\"h-2.5 bg-gray-100 animate-pulse rounded w-20\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Next Skeleton */}\n          <div className=\"w-1/4 md:w-1/5 -ml-4 md:-ml-6\">\n            <div className=\"w-full h-[180px] sm:h-[220px] md:h-[280px] lg:h-[320px] bg-gray-100 animate-pulse rounded-lg\" />\n          </div>\n        </div>\n\n        {/* Skeleton Dots */}\n        <div className=\"mt-4 text-center\">\n          {[1, 2, 3, 4, 5].map((_, index) => (\n            <div\n              key={index}\n              className=\"w-1.5 h-1.5 rounded-full bg-gray-200 inline-block mx-1\"\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const getAdjacentIndex = (offset: number) => {\n    return (currentIndex + offset + filteredNews.length) % filteredNews.length;\n  };\n\n  return (\n    <div className=\"w-full\">\n      <div \n        className=\"relative group\"\n        onTouchStart={onTouchStart}\n        onTouchMove={onTouchMove}\n        onTouchEnd={onTouchEnd}\n      >\n        <button\n          onClick={handlePrevious}\n          className=\"absolute left-2 top-1/2 -translate-y-1/2 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-lg hidden md:block opacity-0 md:group-hover:opacity-100 transition-opacity duration-200 hover:bg-white\"\n          aria-label=\"Previous slide\"\n        >\n          <ChevronLeft className=\"w-6 h-6 text-gray-600\" />\n        </button>\n\n        <button\n          onClick={handleNext}\n          className=\"absolute right-2 top-1/2 -translate-y-1/2 z-10 p-2 rounded-full bg-white/80 backdrop-blur-sm shadow-lg hidden md:block opacity-0 md:group-hover:opacity-100 transition-opacity duration-200 hover:bg-white\"\n          aria-label=\"Next slide\"\n        >\n          <ChevronRight className=\"w-6 h-6 text-gray-600\" />\n        </button>\n\n        <div className=\"relative flex items-center justify-center gap-0 px-4 md:px-12 overflow-visible\">\n          <AnimatePresence mode=\"popLayout\" initial={false}>\n            {/* Previous Image */}\n            <motion.div\n              key={`prev-${currentIndex}`}\n              initial={{ \n                x: 100,\n                opacity: 0,\n                scale: 0.8,\n                zIndex: 1\n              }}\n              animate={{ \n                x: 0,\n                opacity: 0.7,\n                scale: 1.5,\n                zIndex: 1,\n                y: 40,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              exit={{ \n                x: -100,\n                opacity: 0,\n                scale: 0.8,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              className=\"w-1/4 md:w-1/5 -mr-4 md:-mr-6\"\n            >\n              <NewsPreviewCard \n                news={filteredNews[getAdjacentIndex(-1)]} \n                variant=\"main\"\n                showTitle={false}\n              />\n            </motion.div>\n\n            {/* Current Image */}\n            <motion.div\n              key={`current-${currentIndex}`}\n              initial={{ \n                x: direction * 100,\n                opacity: 0,\n                scale: 0.9,\n                zIndex: 2\n              }}\n              animate={{ \n                x: 0,\n                opacity: 1,\n                scale: 1.4,\n                zIndex: 2,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              exit={{ \n                x: -direction * 100,\n                opacity: 0,\n                scale: 0.9,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              className=\"w-2/3 md:w-3/4\"\n            >\n              <NewsPreviewCard \n                news={filteredNews[currentIndex]} \n                variant=\"main\"\n                showTitle={true}\n              />\n            </motion.div>\n\n            {/* Next Image */}\n            <motion.div\n              key={`next-${currentIndex}`}\n              initial={{ \n                x: -100,\n                opacity: 0,\n                scale: 0.8,\n                zIndex: 1\n              }}\n              animate={{ \n                x: 0,\n                opacity: 0.7,\n                scale: 1.5,\n                zIndex: 1,\n                y: 40,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              exit={{ \n                x: 100,\n                opacity: 0,\n                scale: 0.8,\n                transition: {\n                  type: \"spring\",\n                  stiffness: 200,\n                  damping: 25,\n                  mass: 0.8,\n                  velocity: 0.5\n                }\n              }}\n              className=\"w-1/4 md:w-1/5 -ml-4 md:-ml-6\"\n            >\n              <NewsPreviewCard \n                news={filteredNews[getAdjacentIndex(1)]} \n                variant=\"main\"\n                showTitle={false}\n              />\n            </motion.div>\n          </AnimatePresence>\n        </div>\n\n        {/* Dot indicators */}\n        {filteredNews.length > 0 && (\n          <div className=\"mt-4 text-center\">\n            {filteredNews.map((_, i) => (\n              <motion.button\n                key={i}\n                onClick={() => {\n                  setDirection(i > currentIndex ? 1 : -1);\n                  setCurrentIndex(i);\n                  resetTimer();\n                }}\n                className=\"relative inline-block mx-1\"\n                whileHover={{ scale: 1.2 }}\n                whileTap={{ scale: 0.9 }}\n              >\n                <motion.div\n                  className={`w-1.5 h-1.5 rounded-full ${\n                    i === currentIndex ? \"bg-blue-600\" : \"bg-gray-300\"\n                  }`}\n                  animate={{\n                    scale: i === currentIndex ? [1, 1.8, 1.4] : 1,\n                    opacity: i === currentIndex ? 1 : 0.5,\n                  }}\n                  transition={{\n                    duration: 0.4,\n                    ease: \"easeInOut\",\n                    times: [0, 0.5, 1],\n                  }}\n                />\n                {i === currentIndex && (\n                  <motion.div\n                    className=\"absolute inset-0 rounded-full bg-blue-600/20\"\n                    layoutId=\"activeDot\"\n                    transition={{\n                      type: \"spring\",\n                      stiffness: 500,\n                      damping: 30,\n                    }}\n                  />\n                )}\n              </motion.button>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n} ","import { useState, useEffect, useRef } from \"react\";\nimport type { NewsItem } from \"../../types/news\";\n\ninterface CstNewsCardProps {\n  news: NewsItem;\n  isImageLoaded?: boolean;\n  index: number;\n  onImageLoaded: (index: number) => void;\n  canLoad: boolean;\n}\n\nexport default function CstNewsCard({ news, isImageLoaded = false, index, onImageLoaded, canLoad }: CstNewsCardProps) {\n  const [imageLoading, setImageLoading] = useState(!isImageLoaded);\n  const [isVisible, setIsVisible] = useState(false);\n  const [loadAttempted, setLoadAttempted] = useState(false);\n  const [retryCount, setRetryCount] = useState(0);\n  const [isMobile, setIsMobile] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n  const imageRef = useRef<HTMLImageElement>(null);\n  const retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Detect mobile device\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));\n    };\n    checkMobile();\n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // Start loading when canLoad becomes true\n  useEffect(() => {\n    if (canLoad && !isVisible) {\n      setIsVisible(true);\n      setLoadAttempted(true);\n    }\n  }, [canLoad, isVisible]);\n\n  // Setup intersection observer with mobile-specific settings\n  useEffect(() => {\n    observerRef.current = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting && canLoad) {\n            setIsVisible(true);\n            setLoadAttempted(true);\n          }\n        });\n      },\n      {\n        root: null,\n        rootMargin: isMobile ? '300px 0px' : '1500px 0px',\n        threshold: isMobile ? 0.1 : 0\n      }\n    );\n\n    if (containerRef.current) {\n      observerRef.current.observe(containerRef.current);\n    }\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, [canLoad, isMobile]);\n\n  // Force load after a delay if not loaded\n  useEffect(() => {\n    if (canLoad && !loadAttempted) {\n      const timer = setTimeout(() => {\n        if (!loadAttempted) {\n          setIsVisible(true);\n          setLoadAttempted(true);\n        }\n      }, isMobile ? 100 : 500);\n\n      return () => clearTimeout(timer);\n    }\n  }, [canLoad, loadAttempted, isMobile]);\n\n  // Cleanup retry timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (retryTimeoutRef.current) {\n        clearTimeout(retryTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const handleImageError = () => {\n    if (retryCount < 3) { // Reduced retry attempts\n      setRetryCount(prev => prev + 1);\n      setImageLoading(true);\n      \n      // Clear any existing retry timeout\n      if (retryTimeoutRef.current) {\n        clearTimeout(retryTimeoutRef.current);\n      }\n\n      // Force reload with exponential backoff\n      retryTimeoutRef.current = setTimeout(() => {\n        if (imageRef.current && news.image_url) {\n          const timestamp = Date.now();\n          const separator = news.image_url.includes('?') ? '&' : '?';\n          imageRef.current.src = `${news.image_url}${separator}t=${timestamp}`;\n        }\n      }, Math.min(1000 * Math.pow(2, retryCount), 5000)); // Exponential backoff with max 5s\n    } else {\n      // After max retries, show a fallback or error state\n      setImageLoading(false);\n      onImageLoaded(index);\n    }\n  };\n\n  const handleImageLoad = () => {\n    setImageLoading(false);\n    setLoadAttempted(true);\n    onImageLoaded(index);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n  };\n\n  const handleClick = () => {\n    if (news.source_url) {\n      window.open(news.source_url, '_blank', 'noopener,noreferrer');\n    }\n  };\n\n  return (\n    <div \n      onClick={handleClick}\n      className=\"block relative h-full cursor-pointer hover:opacity-90 transition-opacity\"\n      style={{ touchAction: 'pan-y pinch-zoom' }}\n    >\n      <div ref={containerRef} className=\"relative h-full overflow-hidden rounded-lg\">\n        {imageLoading && (\n          <div className=\"h-full w-full bg-gray-100 animate-pulse\" />\n        )}\n        {isVisible && (\n          <img\n            ref={imageRef}\n            src={news.image_url}\n            alt={news.title}\n            className={`h-[239%] w-full object-cover object-top ${\n              imageLoading ? 'hidden' : 'block'\n            }`}\n            onLoad={handleImageLoad}\n            onError={handleImageError}\n            loading={isMobile ? \"eager\" : \"lazy\"}\n            decoding={isMobile ? \"async\" : \"auto\"}\n          />\n        )}\n        <div className=\"absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur-sm mt-1 space-y-1 p-1 text-center\">\n          <h3 className=\"text-xs font-medium text-gray-900 line-clamp-2\">\n            {news.title}\n          </h3>\n          <div className=\"flex items-center justify-center gap-1.5 text-[10px] text-gray-500\">\n            <span>{news.source_url ? new URL(news.source_url).hostname.replace('www.', '') : 'GSU'}</span>\n            <span>•</span>\n            <span>{formatDate(news.published_at)}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n} ","import { useState } from \"react\";\nimport type { NewsItem } from \"../../types/news\";\nimport CstNewsCard from \"./CstNewsCard\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface CstNewsProps {\n  news: NewsItem[];\n  loading: boolean;\n  error: string | null;\n}\n\n// Function to preload images\nconst preloadImages = async (news: NewsItem[]): Promise<Set<string>> => {\n  const preloadedUrls = new Set<string>();\n  \n  await Promise.all(\n    news\n      .filter((item: NewsItem) => item.image_url)\n      .map(async (item: NewsItem) => {\n        const url = item.image_url as string;\n        try {\n          const img = new Image();\n          await new Promise((resolve, reject) => {\n            img.onload = resolve;\n            img.onerror = reject;\n            img.src = url;\n          });\n          preloadedUrls.add(url);\n        } catch (error) {\n          console.warn(`Failed to preload image: ${url}`, error);\n        }\n      })\n  );\n  \n  return preloadedUrls;\n};\n\nexport default function CstNews({ news, loading, error }: CstNewsProps) {\n  const [loadedIndices, setLoadedIndices] = useState<Set<number>>(new Set());\n  const [nextToLoad, setNextToLoad] = useState(0);\n\n  // Use React Query to cache preloaded images\n  const { data: preloadedImages = new Set<string>() } = useQuery<Set<string>>({\n    queryKey: ['cstPreloadedImages', news.map(item => item.id).join(',')],\n    queryFn: () => preloadImages(news),\n    enabled: news.length > 0,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 30 * 60 * 1000, // 30 minutes\n  });\n\n  const handleImageLoaded = (index: number) => {\n    setLoadedIndices(prev => new Set([...prev, index]));\n    setNextToLoad(prev => prev + 1);\n  };\n\n  const checkImageLoaded = (news: NewsItem) => {\n    return news.image_url ? preloadedImages.has(news.image_url) : false;\n  };\n\n  const canLoadImage = (index: number) => {\n    return Math.abs(index - nextToLoad) <= 3 || loadedIndices.has(index - 1) || index < 4;\n  };\n\n  // Only show loading state on initial load\n  if (loading && (!news || news.length === 0)) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {[...Array(6)].map((_, index) => (\n          <div key={index} className=\"aspect-[4/3]\">\n            <div className=\"w-full h-full bg-white rounded-lg shadow-sm overflow-hidden\">\n              {/* Image skeleton */}\n              <div className=\"w-full h-[60%] bg-gray-100 animate-pulse\" />\n              \n              {/* Content skeleton */}\n              <div className=\"p-4 space-y-3\">\n                {/* Title skeleton */}\n                <div className=\"h-4 bg-gray-100 animate-pulse rounded w-3/4\" />\n                \n                {/* Date skeleton */}\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-24\" />\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-16\" />\n                </div>\n                \n                {/* Description skeleton */}\n                <div className=\"space-y-2\">\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-full\" />\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-5/6\" />\n                  <div className=\"h-3 bg-gray-100 animate-pulse rounded w-4/6\" />\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-red-500\">{error}</p>\n      </div>\n    );\n  }\n\n  if (!news || news.length === 0) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-gray-500\">No news available for CST</p>\n      </div>\n    );\n  }\n\n  // Sort news by published_at date and take only the 10 most recent\n  const recentNews = [...news]\n    .sort((a, b) => new Date(b.published_at).getTime() - new Date(a.published_at).getTime())\n    .slice(0, 10);\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n      {recentNews.map((item: NewsItem, index: number) => (\n        <div key={item.id} className=\"aspect-[4/3]\">\n          <CstNewsCard \n            news={item}\n            isImageLoaded={checkImageLoaded(item)}\n            index={index}\n            onImageLoaded={handleImageLoaded}\n            canLoad={canLoadImage(index)}\n          />\n        </div>\n      ))}\n    </div>\n  );\n} ","import { useQuery } from \"@tanstack/react-query\";\nimport { getNews } from \"@/services/newsService\";\nimport type { NewsItem } from \"@/types/news\";\nimport MainCampusNews from \"@/components/news/MainCampusNews\";\nimport CstNews from \"@/components/news/CstNews\";\nimport { motion } from \"framer-motion\";\nimport { Link } from \"react-router-dom\";\nimport { ArrowRight } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\nexport default function Home() {\n  const { data: news = [], isLoading, error } = useQuery<NewsItem[]>({\n    queryKey: ['news'],\n    queryFn: async () => {\n      const { data, error } = await getNews();\n      if (error) throw new Error('Failed to load news');\n      return data;\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 30 * 60 * 1000, // 30 minutes\n    refetchOnWindowFocus: false,\n    retry: 1,\n  });\n\n  const mainCampusNews = news.filter(item => item.campus?.name === \"Main Campus\");\n  const cstNews = news.filter(item => item.campus?.name === \"CST\");\n  const errorMessage = error instanceof Error ? error.message : null;\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-white\">\n      {/* Hero Section */}\n      <section className=\"relative py-16 px-4\">\n        <div className=\"max-w-5xl mx-auto\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"text-center\"\n          >\n            <h1 className=\"text-4xl md:text-5xl font-bold tracking-tight text-gray-900 mb-4\">\n              What's News\n            </h1>\n            <motion.p\n              className=\"text-gray-600 text-base md:text-lg max-w-2xl mx-auto leading-relaxed\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ duration: 0.5, delay: 0.2 }}\n            >\n              Stay informed with the latest updates, events, and announcements from across our campuses\n            </motion.p>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Content Section */}\n      <section className=\"flex-1 overflow-y-auto px-4 py-8\">\n        <div className=\"max-w-6xl mx-auto space-y-12\">\n          {/* Main Campus Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-base font-medium text-gray-700\">Main Campus News</h2>\n              <Link to=\"/news?campus=Main%20Campus\">\n                <Card className=\"hover:bg-gray-50 transition-colors border-gray-300\">\n                  <CardContent className=\"px-2 py-1\">\n                    <div className=\"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-900\">\n                      Show all\n                      <ArrowRight className=\"w-3 h-3\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </div>\n            <MainCampusNews news={mainCampusNews} loading={isLoading} error={errorMessage} />\n          </div>\n\n          <div className=\"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent\" />\n\n          {/* CST Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-base font-medium text-gray-700\">College of Science and Technology</h2>\n              <Link to=\"/news?campus=CST\">\n                <Card className=\"hover:bg-gray-50 transition-colors border-gray-300\">\n                  <CardContent className=\"px-2 py-1\">\n                    <div className=\"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-900\">\n                      Show all\n                      <ArrowRight className=\"w-3 h-3\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </div>\n            <CstNews news={cstNews} loading={isLoading} error={errorMessage} />\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n} \n"],"names":["NewsPreviewCard","news","variant","isImageLoaded","showTitle","imageLoading","setImageLoading","useState","handleImageLoad","getImageHeight","formatDate","dateString","handleClick","e","jsxs","Link","jsx","checkImageAspectRatio","imageUrl","resolve","img","aspectRatio","MainCampusNews","parentLoading","error","currentIndex","setCurrentIndex","direction","setDirection","touchStart","setTouchStart","touchEnd","setTouchEnd","timerRef","useRef","validImages","setValidImages","isImageChecking","setIsImageChecking","useEffect","validUrls","item","filteredNews","a","b","resetTimer","useCallback","onTouchStart","onTouchMove","currentTouch","onTouchEnd","distance","prevIndex","handlePrevious","handleNext","_","index","getAdjacentIndex","offset","ChevronLeft","ChevronRight","AnimatePresence","motion","i","CstNewsCard","onImageLoaded","canLoad","isVisible","setIsVisible","loadAttempted","setLoadAttempted","retryCount","setRetryCount","isMobile","setIsMobile","containerRef","observerRef","imageRef","retryTimeoutRef","checkMobile","entries","entry","timer","handleImageError","prev","timestamp","separator","preloadImages","preloadedUrls","url","reject","CstNews","loading","loadedIndices","setLoadedIndices","nextToLoad","setNextToLoad","preloadedImages","useQuery","handleImageLoaded","checkImageLoaded","canLoadImage","recentNews","Home","isLoading","data","getNews","mainCampusNews","_a","cstNews","errorMessage","Card","CardContent","ArrowRight"],"mappings":"kXAWwB,SAAAA,EAAgB,CAAE,KAAAC,EAAM,QAAAC,EAAS,cAAAC,EAAgB,GAAO,UAAAC,EAAY,IAA8B,CACxH,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAA,SAAS,CAACJ,CAAa,EAEzDK,EAAkB,IAAM,CAC5BF,EAAgB,EAAK,CACvB,EAEMG,EAAiB,IAAM,CAC3B,OAAQP,EAAS,CACf,IAAK,OACI,MAAA,mDACT,IAAK,QACI,MAAA,mDACT,QACS,MAAA,WAAA,CAEb,EAEMQ,EAAcC,GACX,IAAI,KAAKA,CAAU,EAAE,mBAAmB,QAAS,CACxD,KAAM,UACN,MAAO,OACP,IAAK,SAAA,CACN,EAGKC,EAAeC,GAAwB,CACvCZ,EAAK,aACPY,EAAE,eAAe,EACjB,OAAO,KAAKZ,EAAK,WAAY,SAAU,qBAAqB,EAEhE,EAGE,OAAAa,EAAA,KAACC,EAAA,CACC,GAAId,EAAK,WAAa,IAAM,SAASA,EAAK,EAAE,GAC5C,QAASW,EACT,UAAU,iBAEV,SAAA,CAACE,EAAAA,KAAA,MAAA,CAAI,UAAU,WACZ,SAAA,CAAAT,SACE,MAAI,CAAA,UAAW,GAAGI,EAAA,CAAgB,oCAAqC,EAE1EO,EAAA,IAAC,MAAA,CACC,IAAKf,EAAK,UACV,IAAKA,EAAK,MACV,UAAW,GAAGQ,EAAgB,CAAA,0BAC5BJ,EAAe,SAAW,OAC5B,GACA,OAAQG,CAAA,CAAA,CACV,EACF,EACCJ,EACCU,EAAA,KAAC,MAAI,CAAA,UAAU,6GACb,SAAA,CAAAE,EAAA,IAAC,KAAG,CAAA,UAAU,8GACX,SAAAf,EAAK,MACR,EACAa,EAAAA,KAAC,MAAI,CAAA,UAAU,0GACb,SAAA,CAAAE,EAAA,IAAC,OAAK,CAAA,UAAU,wCAAyC,SAAAf,EAAK,WAAa,IAAI,IAAIA,EAAK,UAAU,EAAE,SAAS,QAAQ,OAAQ,EAAE,EAAI,MAAM,EACzIe,EAAAA,IAAC,QAAK,SAAC,GAAA,CAAA,EACNA,EAAA,IAAA,OAAA,CAAM,SAAWN,EAAAT,EAAK,YAAY,CAAE,CAAA,CAAA,CACzC,CAAA,CAAA,CAAA,CACA,EAEAe,EAAA,IAAC,MAAI,CAAA,UAAU,sBAAuB,CAAA,CAAA,CAAA,CAE1C,CAEJ,CClEA,MAAMC,EAAyBC,GACtB,IAAI,QAASC,GAAY,CACxB,MAAAC,EAAM,IAAI,MAChBA,EAAI,OAAS,IAAM,CACX,MAAAC,EAAcD,EAAI,MAAQA,EAAI,OACpCD,EAAQE,GAAe,GAAKA,GAAe,GAAG,CAAC,CACjD,EACAD,EAAI,QAAU,IAAM,CAClBD,EAAQ,EAAK,CACf,EACAC,EAAI,IAAMF,CAAA,CACX,EAGH,SAAwBI,EAAe,CAAE,KAAArB,EAAM,QAASsB,EAAe,MAAAC,GAA8B,CACnG,KAAM,CAACC,EAAcC,CAAe,EAAInB,EAAAA,SAAS,CAAC,EAC5C,CAACoB,EAAWC,CAAY,EAAIrB,EAAAA,SAAS,CAAC,EACtC,CAACsB,EAAYC,CAAa,EAAIvB,EAAAA,SAAwB,IAAI,EAC1D,CAACwB,EAAUC,CAAW,EAAIzB,EAAAA,SAAwB,IAAI,EACtD0B,EAAWC,SAAmC,MAAS,EACvD,CAACC,EAAaC,CAAc,EAAI7B,EAAAA,SAAsB,IAAI,GAAK,EAC/D,CAAC8B,EAAiBC,CAAkB,EAAI/B,EAAAA,SAAS,EAAK,EAG5DgC,EAAAA,UAAU,IAAM,EACM,SAAY,CAC1B,GAAAtC,EAAK,SAAW,EAAG,OAEvBqC,EAAmB,EAAI,EAEjB,MAAAE,MAAgB,IAEtB,UAAWC,KAAQxC,EACbwC,EAAK,WACS,MAAMxB,EAAsBwB,EAAK,SAAS,GAE9CD,EAAA,IAAIC,EAAK,SAAS,EAKlCL,EAAeI,CAAS,EACxBF,EAAmB,EAAK,CAC1B,GAEY,CAAA,EACX,CAACrC,CAAI,CAAC,EAGT,MAAMyC,EAAezC,EAClB,OAAOwC,GAAQA,EAAK,WAAaN,EAAY,IAAIM,EAAK,SAAS,CAAC,EAChE,KAAK,CAACE,EAAGC,IAAM,IAAI,KAAKA,EAAE,UAAU,EAAE,QAAA,EAAY,IAAI,KAAKD,EAAE,UAAU,EAAE,QAAS,CAAA,EAClF,MAAM,EAAG,CAAC,EAEPE,EAAaC,EAAAA,YAAY,IAAM,CAC/Bb,EAAS,SACX,cAAcA,EAAS,OAAO,CAChC,EAMC,CAACS,EAAa,MAAM,CAAC,EAExBH,EAAAA,UAAU,IAKD,IAAM,CACPN,EAAS,SACX,cAAcA,EAAS,OAAO,CAElC,EACC,CAACS,EAAa,OAAQG,CAAU,CAAC,EAE9B,MAAAE,EAAgBlC,GAAwB,CAC5CmB,EAAY,IAAI,EAChBF,EAAcjB,EAAE,cAAc,CAAC,EAAE,OAAO,CAE1C,EAEMmC,EAAenC,GAAwB,CAC3C,MAAMoC,EAAepC,EAAE,cAAc,CAAC,EAAE,QACxCmB,EAAYiB,CAAY,CAC1B,EAEMC,EAAa,IAAM,CACnB,GAAA,CAACrB,GAAc,CAACE,EAAU,OAC9B,MAAMoB,EAAWtB,EAAaE,EAG1B,KAAK,IAAIoB,CAAQ,EAFI,KAGnBA,EAAW,EACbzB,EAAiB0B,IAAeA,EAAY,GAAKV,EAAa,MAAM,EAEpEhB,EAAiB0B,IAAeA,EAAY,EAAIV,EAAa,QAAUA,EAAa,MAAM,EAIhG,EAEMW,EAAiB,IAAM,CAC3BzB,EAAa,EAAE,EACfF,EAAiB0B,IAAeA,EAAY,EAAIV,EAAa,QAAUA,EAAa,MAAM,CAE5F,EAEMY,EAAa,IAAM,CACvB1B,EAAa,CAAC,EACdF,EAAiB0B,IAAeA,EAAY,GAAKV,EAAa,MAAM,CAEtE,EAGA,GAAInB,IAAkB,CAACtB,GAAQA,EAAK,SAAW,GAE3C,OAAAa,EAAA,KAAC,MAAI,CAAA,UAAU,yBACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,iFAEb,SAAA,CAAAE,EAAAA,IAAC,OAAI,UAAU,gCACb,eAAC,MAAI,CAAA,UAAU,+FAA+F,CAChH,CAAA,EAGAF,EAAAA,KAAC,MAAI,CAAA,UAAU,iBACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,8FAA+F,CAAA,EAC9GF,EAAAA,KAAC,MAAI,CAAA,UAAU,yBACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,qDAAsD,CAAA,EACrEF,EAAAA,KAAC,MAAI,CAAA,UAAU,2CACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,8CAA+C,CAAA,EAC9DA,EAAAA,IAAC,MAAI,CAAA,UAAU,6CAA8C,CAAA,EAC7DA,EAAAA,IAAC,MAAI,CAAA,UAAU,8CAA+C,CAAA,CAAA,CAChE,CAAA,CAAA,CACF,CAAA,CAAA,EACF,EAGAA,EAAAA,IAAC,OAAI,UAAU,gCACb,eAAC,MAAI,CAAA,UAAU,8FAA+F,CAAA,CAChH,CAAA,CAAA,EACF,EAGCA,EAAA,IAAA,MAAA,CAAI,UAAU,mBACZ,UAAC,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAI,CAACuC,EAAGC,IACvBxC,EAAA,IAAC,MAAA,CAEC,UAAU,wDAAA,EADLwC,CAAA,CAGR,CACH,CAAA,CAAA,EACF,EAKJ,GAAIhC,EAEA,OAAAV,EAAA,KAAC,MAAI,CAAA,UAAU,mBACb,SAAA,CAACE,EAAA,IAAA,IAAA,CAAE,UAAU,oBAAqB,SAAMQ,EAAA,EACxCR,EAAA,IAAC,SAAA,CACC,QAAS,IAAM,OAAO,SAAS,OAAO,EACtC,UAAU,kFACX,SAAA,WAAA,CAAA,CAED,EACF,EAKJ,GAAI0B,EAAa,SAAW,GAAK,CAACL,EAE9B,OAAArB,EAAA,IAAC,OAAI,UAAU,mBACb,eAAC,IAAE,CAAA,UAAU,gBAAgB,SAAA,mCAAA,CAAiC,CAChE,CAAA,EAKA,GAAAqB,GAAmBK,EAAa,SAAW,EAE3C,OAAA5B,EAAA,KAAC,MAAI,CAAA,UAAU,yBACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,iFAEb,SAAA,CAAAE,EAAAA,IAAC,OAAI,UAAU,gCACb,eAAC,MAAI,CAAA,UAAU,+FAA+F,CAChH,CAAA,EAGAF,EAAAA,KAAC,MAAI,CAAA,UAAU,iBACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,8FAA+F,CAAA,EAC9GF,EAAAA,KAAC,MAAI,CAAA,UAAU,yBACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,qDAAsD,CAAA,EACrEF,EAAAA,KAAC,MAAI,CAAA,UAAU,2CACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,8CAA+C,CAAA,EAC9DA,EAAAA,IAAC,MAAI,CAAA,UAAU,6CAA8C,CAAA,EAC7DA,EAAAA,IAAC,MAAI,CAAA,UAAU,8CAA+C,CAAA,CAAA,CAChE,CAAA,CAAA,CACF,CAAA,CAAA,EACF,EAGAA,EAAAA,IAAC,OAAI,UAAU,gCACb,eAAC,MAAI,CAAA,UAAU,8FAA+F,CAAA,CAChH,CAAA,CAAA,EACF,EAGCA,EAAA,IAAA,MAAA,CAAI,UAAU,mBACZ,UAAC,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,IAAI,CAACuC,EAAGC,IACvBxC,EAAA,IAAC,MAAA,CAEC,UAAU,wDAAA,EADLwC,CAAA,CAGR,CACH,CAAA,CAAA,EACF,EAIE,MAAAC,EAAoBC,IAChBjC,EAAeiC,EAAShB,EAAa,QAAUA,EAAa,OAIpE,OAAA1B,EAAAA,IAAC,MAAI,CAAA,UAAU,SACb,SAAAF,EAAA,KAAC,MAAA,CACC,UAAU,iBACV,aAAAiC,EACA,YAAAC,EACA,WAAAE,EAEA,SAAA,CAAAlC,EAAA,IAAC,SAAA,CACC,QAASqC,EACT,UAAU,4MACV,aAAW,iBAEX,SAAArC,EAAAA,IAAC2C,EAAY,CAAA,UAAU,uBAAwB,CAAA,CAAA,CACjD,EAEA3C,EAAA,IAAC,SAAA,CACC,QAASsC,EACT,UAAU,6MACV,aAAW,aAEX,SAAAtC,EAAAA,IAAC4C,EAAa,CAAA,UAAU,uBAAwB,CAAA,CAAA,CAClD,EAEA5C,EAAAA,IAAC,OAAI,UAAU,iFACb,gBAAC6C,EAAgB,CAAA,KAAK,YAAY,QAAS,GAEzC,SAAA,CAAA7C,EAAA,IAAC8C,EAAO,IAAP,CAEC,QAAS,CACP,EAAG,IACH,QAAS,EACT,MAAO,GACP,OAAQ,CACV,EACA,QAAS,CACP,EAAG,EACH,QAAS,GACT,MAAO,IACP,OAAQ,EACR,EAAG,GACH,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,GACT,KAAM,GACN,SAAU,EAAA,CAEd,EACA,KAAM,CACJ,EAAG,KACH,QAAS,EACT,MAAO,GACP,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,GACT,KAAM,GACN,SAAU,EAAA,CAEd,EACA,UAAU,gCAEV,SAAA9C,EAAA,IAAChB,EAAA,CACC,KAAM0C,EAAae,EAAiB,EAAE,CAAC,EACvC,QAAQ,OACR,UAAW,EAAA,CAAA,CACb,EAvCK,QAAQhC,CAAY,EAwC3B,EAGAT,EAAA,IAAC8C,EAAO,IAAP,CAEC,QAAS,CACP,EAAGnC,EAAY,IACf,QAAS,EACT,MAAO,GACP,OAAQ,CACV,EACA,QAAS,CACP,EAAG,EACH,QAAS,EACT,MAAO,IACP,OAAQ,EACR,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,GACT,KAAM,GACN,SAAU,EAAA,CAEd,EACA,KAAM,CACJ,EAAG,CAACA,EAAY,IAChB,QAAS,EACT,MAAO,GACP,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,GACT,KAAM,GACN,SAAU,EAAA,CAEd,EACA,UAAU,iBAEV,SAAAX,EAAA,IAAChB,EAAA,CACC,KAAM0C,EAAajB,CAAY,EAC/B,QAAQ,OACR,UAAW,EAAA,CAAA,CACb,EAtCK,WAAWA,CAAY,EAuC9B,EAGAT,EAAA,IAAC8C,EAAO,IAAP,CAEC,QAAS,CACP,EAAG,KACH,QAAS,EACT,MAAO,GACP,OAAQ,CACV,EACA,QAAS,CACP,EAAG,EACH,QAAS,GACT,MAAO,IACP,OAAQ,EACR,EAAG,GACH,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,GACT,KAAM,GACN,SAAU,EAAA,CAEd,EACA,KAAM,CACJ,EAAG,IACH,QAAS,EACT,MAAO,GACP,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,GACT,KAAM,GACN,SAAU,EAAA,CAEd,EACA,UAAU,gCAEV,SAAA9C,EAAA,IAAChB,EAAA,CACC,KAAM0C,EAAae,EAAiB,CAAC,CAAC,EACtC,QAAQ,OACR,UAAW,EAAA,CAAA,CACb,EAvCK,QAAQhC,CAAY,EAAA,CAwC3B,CAAA,CACF,CACF,CAAA,EAGCiB,EAAa,OAAS,GACpB1B,EAAAA,IAAA,MAAA,CAAI,UAAU,mBACZ,SAAa0B,EAAA,IAAI,CAACa,EAAGQ,IACpBjD,EAAA,KAACgD,EAAO,OAAP,CAEC,QAAS,IAAM,CACAlC,EAAAmC,EAAItC,EAAe,EAAI,EAAE,EACtCC,EAAgBqC,CAAC,EACNlB,EAAA,CACb,EACA,UAAU,6BACV,WAAY,CAAE,MAAO,GAAI,EACzB,SAAU,CAAE,MAAO,EAAI,EAEvB,SAAA,CAAA7B,EAAA,IAAC8C,EAAO,IAAP,CACC,UAAW,4BACTC,IAAMtC,EAAe,cAAgB,aACvC,GACA,QAAS,CACP,MAAOsC,IAAMtC,EAAe,CAAC,EAAG,IAAK,GAAG,EAAI,EAC5C,QAASsC,IAAMtC,EAAe,EAAI,EACpC,EACA,WAAY,CACV,SAAU,GACV,KAAM,YACN,MAAO,CAAC,EAAG,GAAK,CAAC,CAAA,CACnB,CACF,EACCsC,IAAMtC,GACLT,EAAA,IAAC8C,EAAO,IAAP,CACC,UAAU,+CACV,SAAS,YACT,WAAY,CACV,KAAM,SACN,UAAW,IACX,QAAS,EAAA,CACX,CAAA,CACF,CAAA,EAjCGC,CAAA,CAoCR,CACH,CAAA,CAAA,CAAA,CAAA,EAGN,CAEJ,CCnbwB,SAAAC,EAAY,CAAE,KAAA/D,EAAM,cAAAE,EAAgB,GAAO,MAAAqD,EAAO,cAAAS,EAAe,QAAAC,GAA6B,CACpH,KAAM,CAAC7D,EAAcC,CAAe,EAAIC,EAAA,SAAS,CAACJ,CAAa,EACzD,CAACgE,EAAWC,CAAY,EAAI7D,EAAAA,SAAS,EAAK,EAC1C,CAAC8D,EAAeC,CAAgB,EAAI/D,EAAAA,SAAS,EAAK,EAClD,CAACgE,EAAYC,CAAa,EAAIjE,EAAAA,SAAS,CAAC,EACxC,CAACkE,EAAUC,CAAW,EAAInE,EAAAA,SAAS,EAAK,EACxCoE,EAAezC,SAAuB,IAAI,EAC1C0C,EAAc1C,SAAoC,IAAI,EACtD2C,EAAW3C,SAAyB,IAAI,EACxC4C,EAAkB5C,SAA8B,IAAI,EAG1DK,EAAAA,UAAU,IAAM,CACd,MAAMwC,EAAc,IAAM,CACxBL,EAAY,4BAA4B,KAAK,UAAU,SAAS,CAAC,CACnE,EACY,OAAAK,EAAA,EACL,OAAA,iBAAiB,SAAUA,CAAW,EACtC,IAAM,OAAO,oBAAoB,SAAUA,CAAW,CAC/D,EAAG,EAAE,EAGLxC,EAAAA,UAAU,IAAM,CACV2B,GAAW,CAACC,IACdC,EAAa,EAAI,EACjBE,EAAiB,EAAI,EACvB,EACC,CAACJ,EAASC,CAAS,CAAC,EAGvB5B,EAAAA,UAAU,KACRqC,EAAY,QAAU,IAAI,qBACvBI,GAAY,CACHA,EAAA,QAASC,GAAU,CACrBA,EAAM,gBAAkBf,IAC1BE,EAAa,EAAI,EACjBE,EAAiB,EAAI,EACvB,CACD,CACH,EACA,CACE,KAAM,KACN,WAAYG,EAAW,YAAc,aACrC,UAAWA,EAAW,GAAM,CAAA,CAEhC,EAEIE,EAAa,SACHC,EAAA,QAAQ,QAAQD,EAAa,OAAO,EAG3C,IAAM,CACPC,EAAY,SACdA,EAAY,QAAQ,WAAW,CAEnC,GACC,CAACV,EAASO,CAAQ,CAAC,EAGtBlC,EAAAA,UAAU,IAAM,CACV,GAAA2B,GAAW,CAACG,EAAe,CACvB,MAAAa,EAAQ,WAAW,IAAM,CACxBb,IACHD,EAAa,EAAI,EACjBE,EAAiB,EAAI,EACvB,EACCG,EAAW,IAAM,GAAG,EAEhB,MAAA,IAAM,aAAaS,CAAK,CAAA,CAEhC,EAAA,CAAChB,EAASG,EAAeI,CAAQ,CAAC,EAGrClC,EAAAA,UAAU,IACD,IAAM,CACPuC,EAAgB,SAClB,aAAaA,EAAgB,OAAO,CAExC,EACC,EAAE,EAEL,MAAMK,EAAmB,IAAM,CACzBZ,EAAa,GACDC,EAAAY,GAAQA,EAAO,CAAC,EAC9B9E,EAAgB,EAAI,EAGhBwE,EAAgB,SAClB,aAAaA,EAAgB,OAAO,EAItBA,EAAA,QAAU,WAAW,IAAM,CACrC,GAAAD,EAAS,SAAW5E,EAAK,UAAW,CAChC,MAAAoF,EAAY,KAAK,IAAI,EACrBC,EAAYrF,EAAK,UAAU,SAAS,GAAG,EAAI,IAAM,IAC9C4E,EAAA,QAAQ,IAAM,GAAG5E,EAAK,SAAS,GAAGqF,CAAS,KAAKD,CAAS,EAAA,CACpE,EACC,KAAK,IAAI,IAAO,KAAK,IAAI,EAAGd,CAAU,EAAG,GAAI,CAAC,IAGjDjE,EAAgB,EAAK,EACrB2D,EAAcT,CAAK,EAEvB,EAEMhD,EAAkB,IAAM,CAC5BF,EAAgB,EAAK,EACrBgE,EAAiB,EAAI,EACrBL,EAAcT,CAAK,CACrB,EAEM9C,EAAcC,GACX,IAAI,KAAKA,CAAU,EAAE,mBAAmB,QAAS,CACtD,KAAM,UACN,MAAO,OACP,IAAK,SAAA,CACN,EAGGC,EAAc,IAAM,CACpBX,EAAK,YACP,OAAO,KAAKA,EAAK,WAAY,SAAU,qBAAqB,CAEhE,EAGE,OAAAe,EAAA,IAAC,MAAA,CACC,QAASJ,EACT,UAAU,2EACV,MAAO,CAAE,YAAa,kBAAmB,EAEzC,SAACE,EAAAA,KAAA,MAAA,CAAI,IAAK6D,EAAc,UAAU,6CAC/B,SAAA,CACCtE,GAAAW,EAAAA,IAAC,MAAI,CAAA,UAAU,yCAA0C,CAAA,EAE1DmD,GACCnD,EAAA,IAAC,MAAA,CACC,IAAK6D,EACL,IAAK5E,EAAK,UACV,IAAKA,EAAK,MACV,UAAW,2CACTI,EAAe,SAAW,OAC5B,GACA,OAAQG,EACR,QAAS2E,EACT,QAASV,EAAW,QAAU,OAC9B,SAAUA,EAAW,QAAU,MAAA,CACjC,EAEF3D,EAAAA,KAAC,MAAI,CAAA,UAAU,+FACb,SAAA,CAAAE,EAAA,IAAC,KAAG,CAAA,UAAU,iDACX,SAAAf,EAAK,MACR,EACAa,EAAAA,KAAC,MAAI,CAAA,UAAU,qEACb,SAAA,CAAAE,EAAA,IAAC,OAAM,CAAA,SAAAf,EAAK,WAAa,IAAI,IAAIA,EAAK,UAAU,EAAE,SAAS,QAAQ,OAAQ,EAAE,EAAI,MAAM,EACvFe,EAAAA,IAAC,QAAK,SAAC,GAAA,CAAA,EACNA,EAAA,IAAA,OAAA,CAAM,SAAWN,EAAAT,EAAK,YAAY,CAAE,CAAA,CAAA,CACvC,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAEJ,CClKA,MAAMsF,EAAgB,MAAOtF,GAA2C,CAChE,MAAAuF,MAAoB,IAE1B,aAAM,QAAQ,IACZvF,EACG,OAAQwC,GAAmBA,EAAK,SAAS,EACzC,IAAI,MAAOA,GAAmB,CAC7B,MAAMgD,EAAMhD,EAAK,UACb,GAAA,CACI,MAAArB,EAAM,IAAI,MAChB,MAAM,IAAI,QAAQ,CAACD,EAASuE,IAAW,CACrCtE,EAAI,OAASD,EACbC,EAAI,QAAUsE,EACdtE,EAAI,IAAMqE,CAAA,CACX,EACDD,EAAc,IAAIC,CAAG,QACdjE,EAAO,CACd,QAAQ,KAAK,4BAA4BiE,CAAG,GAAIjE,CAAK,CAAA,CAExD,CAAA,CACL,EAEOgE,CACT,EAEA,SAAwBG,EAAQ,CAAE,KAAA1F,EAAM,QAAA2F,EAAS,MAAApE,GAAuB,CACtE,KAAM,CAACqE,EAAeC,CAAgB,EAAIvF,EAAAA,SAAsB,IAAI,GAAK,EACnE,CAACwF,EAAYC,CAAa,EAAIzF,EAAAA,SAAS,CAAC,EAGxC,CAAE,KAAM0F,MAAsB,GAAY,EAAMC,EAAsB,CAC1E,SAAU,CAAC,qBAAsBjG,EAAK,IAAYwC,GAAAA,EAAK,EAAE,EAAE,KAAK,GAAG,CAAC,EACpE,QAAS,IAAM8C,EAActF,CAAI,EACjC,QAASA,EAAK,OAAS,EACvB,UAAW,EAAI,GAAK,IACpB,OAAQ,GAAK,GAAK,GAAA,CACnB,EAEKkG,EAAqB3C,GAAkB,CAC1BsC,EAAAV,OAAY,IAAI,CAAC,GAAGA,EAAM5B,CAAK,CAAC,CAAC,EACpCwC,EAAAZ,GAAQA,EAAO,CAAC,CAChC,EAEMgB,EAAoBnG,GACjBA,EAAK,UAAYgG,EAAgB,IAAIhG,EAAK,SAAS,EAAI,GAG1DoG,EAAgB7C,GACb,KAAK,IAAIA,EAAQuC,CAAU,GAAK,GAAKF,EAAc,IAAIrC,EAAQ,CAAC,GAAKA,EAAQ,EAItF,GAAIoC,IAAY,CAAC3F,GAAQA,EAAK,SAAW,GAErC,OAAAe,MAAC,OAAI,UAAU,uDACZ,UAAC,GAAG,MAAM,CAAC,CAAC,EAAE,IAAI,CAACuC,EAAGC,IACpBxC,MAAA,MAAA,CAAgB,UAAU,eACzB,SAAAF,EAAA,KAAC,MAAI,CAAA,UAAU,8DAEb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,0CAA2C,CAAA,EAG1DF,EAAAA,KAAC,MAAI,CAAA,UAAU,gBAEb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,6CAA8C,CAAA,EAG7DF,EAAAA,KAAC,MAAI,CAAA,UAAU,8BACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,4CAA6C,CAAA,EAC5DA,EAAAA,IAAC,MAAI,CAAA,UAAU,4CAA6C,CAAA,CAAA,EAC9D,EAGAF,EAAAA,KAAC,MAAI,CAAA,UAAU,YACb,SAAA,CAACE,EAAAA,IAAA,MAAA,CAAI,UAAU,8CAA+C,CAAA,EAC9DA,EAAAA,IAAC,MAAI,CAAA,UAAU,6CAA8C,CAAA,EAC7DA,EAAAA,IAAC,MAAI,CAAA,UAAU,6CAA8C,CAAA,CAAA,CAC/D,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CAAA,EAvBQwC,CAwBV,CACD,EACH,EAIJ,GAAIhC,EAEA,OAAAR,EAAA,IAAC,OAAI,UAAU,mBACb,eAAC,IAAE,CAAA,UAAU,eAAgB,SAAAQ,CAAA,CAAM,CACrC,CAAA,EAIJ,GAAI,CAACvB,GAAQA,EAAK,SAAW,EAEzB,OAAAe,EAAA,IAAC,OAAI,UAAU,mBACb,eAAC,IAAE,CAAA,UAAU,gBAAgB,SAAA,2BAAA,CAAyB,CACxD,CAAA,EAKE,MAAAsF,EAAa,CAAC,GAAGrG,CAAI,EACxB,KAAK,CAAC0C,EAAGC,IAAM,IAAI,KAAKA,EAAE,YAAY,EAAE,UAAY,IAAI,KAAKD,EAAE,YAAY,EAAE,QAAA,CAAS,EACtF,MAAM,EAAG,EAAE,EAEd,OACG3B,EAAAA,IAAA,MAAA,CAAI,UAAU,uDACZ,SAAWsF,EAAA,IAAI,CAAC7D,EAAgBe,IAC/BxC,EAAAA,IAAC,MAAkB,CAAA,UAAU,eAC3B,SAAAA,EAAA,IAACgD,EAAA,CACC,KAAMvB,EACN,cAAe2D,EAAiB3D,CAAI,EACpC,MAAAe,EACA,cAAe2C,EACf,QAASE,EAAa7C,CAAK,CAAA,CANrB,CAAA,EAAAf,EAAK,EAQf,CACD,EACH,CAEJ,CC5HA,SAAwB8D,IAAO,CACvB,KAAA,CAAE,KAAMtG,EAAO,CAAA,EAAI,UAAAuG,EAAW,MAAAhF,GAAU0E,EAAqB,CACjE,SAAU,CAAC,MAAM,EACjB,QAAS,SAAY,CACnB,KAAM,CAAE,KAAAO,EAAM,MAAAjF,CAAM,EAAI,MAAMkF,EAAQ,EACtC,GAAIlF,EAAO,MAAM,IAAI,MAAM,qBAAqB,EACzC,OAAAiF,CACT,EACA,UAAW,IACX,OAAQ,KACR,qBAAsB,GACtB,MAAO,CAAA,CACR,EAEKE,EAAiB1G,EAAK,iBAAe,QAAA2G,EAAAnE,EAAK,SAAL,YAAAmE,EAAa,QAAS,cAAa,EACxEC,EAAU5G,EAAK,iBAAe,QAAA2G,EAAAnE,EAAK,SAAL,YAAAmE,EAAa,QAAS,MAAK,EACzDE,EAAetF,aAAiB,MAAQA,EAAM,QAAU,KAG5D,OAAAV,EAAA,KAAC,MAAI,CAAA,UAAU,sCAEb,SAAA,CAAAE,EAAAA,IAAC,WAAQ,UAAU,sBACjB,SAACA,MAAA,MAAA,CAAI,UAAU,oBACb,SAAAF,EAAA,KAACgD,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAG,EAC7B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAE,EAC5B,WAAY,CAAE,SAAU,EAAI,EAC5B,UAAU,cAEV,SAAA,CAAC9C,EAAA,IAAA,KAAA,CAAG,UAAU,mEAAmE,SAEjF,cAAA,EACAA,EAAA,IAAC8C,EAAO,EAAP,CACC,UAAU,uEACV,QAAS,CAAE,QAAS,CAAE,EACtB,QAAS,CAAE,QAAS,CAAE,EACtB,WAAY,CAAE,SAAU,GAAK,MAAO,EAAI,EACzC,SAAA,2FAAA,CAAA,CAED,CAAA,GAEJ,CACF,CAAA,QAGC,UAAQ,CAAA,UAAU,mCACjB,SAAChD,EAAA,KAAA,MAAA,CAAI,UAAU,+BAEb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,oCACb,SAAA,CAACE,EAAA,IAAA,KAAA,CAAG,UAAU,sCAAsC,SAAgB,mBAAA,EACnEA,MAAAD,EAAA,CAAK,GAAG,6BACP,eAACgG,EAAK,CAAA,UAAU,qDACd,SAAA/F,EAAA,IAACgG,GAAY,UAAU,YACrB,SAAClG,OAAA,MAAA,CAAI,UAAU,oEAAoE,SAAA,CAAA,WAEjFE,EAAAA,IAACiG,EAAW,CAAA,UAAU,SAAU,CAAA,CAAA,EAClC,CAAA,CACF,EACF,CACF,CAAA,CAAA,EACF,QACC3F,EAAe,CAAA,KAAMqF,EAAgB,QAASH,EAAW,MAAOM,CAAc,CAAA,CAAA,EACjF,EAEA9F,EAAAA,IAAC,MAAI,CAAA,UAAU,oEAAqE,CAAA,EAGpFF,EAAAA,KAAC,MAAI,CAAA,UAAU,YACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,oCACb,SAAA,CAACE,EAAA,IAAA,KAAA,CAAG,UAAU,sCAAsC,SAAiC,oCAAA,EACpFA,MAAAD,EAAA,CAAK,GAAG,mBACP,eAACgG,EAAK,CAAA,UAAU,qDACd,SAAA/F,EAAA,IAACgG,GAAY,UAAU,YACrB,SAAClG,OAAA,MAAA,CAAI,UAAU,oEAAoE,SAAA,CAAA,WAEjFE,EAAAA,IAACiG,EAAW,CAAA,UAAU,SAAU,CAAA,CAAA,EAClC,CAAA,CACF,EACF,CACF,CAAA,CAAA,EACF,QACCtB,EAAQ,CAAA,KAAMkB,EAAS,QAASL,EAAW,MAAOM,CAAc,CAAA,CAAA,CACnE,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAAA,EACF,CAEJ"}