{"version":3,"file":"Home-b-Rx-ecI.js","sources":["../../src/components/news/MainCampusNews.tsx","../../src/components/news/CstNewsCard.tsx","../../src/components/news/CstNews.tsx","../../src/pages/Home.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport type { NewsItem } from \"@/types/news\";\nimport { motion } from \"framer-motion\";\n\ninterface MainCampusNewsProps {\n  news: NewsItem[];\n  loading: boolean;\n  error: string | null;\n}\n\nexport default function MainCampusNews({ news, loading, error }: MainCampusNewsProps) {\n  const [showMenu, setShowMenu] = useState<number | null>(null);\n\n  // Get only the 3 most recent news items with images for better visibility\n  const filteredNews = news\n    .filter(item => item.image_url)\n    .sort((a, b) => new Date(b.published_at).getTime() - new Date(a.published_at).getTime())\n    .slice(0, 3);\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n  };\n\n  const handleMenuClick = (e: React.MouseEvent, index: number) => {\n    e.stopPropagation();\n    setShowMenu(showMenu === index ? null : index);\n  };\n\n  const handleViewSource = (e: React.MouseEvent, item: NewsItem) => {\n    e.stopPropagation();\n    if (item.source_url) {\n      window.open(item.source_url, '_blank', 'noopener,noreferrer');\n    }\n    setShowMenu(null);\n  };\n\n  const handleShare = async (e: React.MouseEvent, item: NewsItem) => {\n    e.stopPropagation();\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: item.title,\n          text: item.content.substring(0, 100),\n          url: item.source_url || window.location.href,\n        });\n      } catch (error) {\n        console.log('Share cancelled or failed');\n      }\n    } else {\n      // Fallback: copy to clipboard\n      const shareText = `${item.title}\\n\\n${item.content.substring(0, 100)}...\\n\\nRead more: ${item.source_url || window.location.href}`;\n      try {\n        await navigator.clipboard.writeText(shareText);\n        console.log('Content copied to clipboard');\n      } catch (error) {\n        console.error('Failed to copy to clipboard');\n      }\n    }\n    setShowMenu(null);\n  };\n\n  // Close menu when clicking outside\n  const handleClickOutside = () => {\n    setShowMenu(null);\n  };\n\n  // Show loading state\n  if (loading && (!news || news.length === 0)) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        {[...Array(3)].map((_, index) => (\n          <motion.div\n            key={index}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.3, delay: index * 0.1 }}\n            className=\"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 overflow-hidden\"\n          >\n            <div className=\"h-40 bg-gray-100 dark:bg-gray-800 animate-pulse\" />\n            <div className=\"p-4 space-y-3\">\n              <div className=\"space-y-2\">\n                <div className=\"h-4 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-3/4\" />\n                <div className=\"h-4 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-1/2\" />\n              </div>\n              <div className=\"space-y-2\">\n                <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-full\" />\n                <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-5/6\" />\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-20\" />\n              </div>\n            </div>\n          </motion.div>\n        ))}\n      </div>\n    );\n  }\n\n  // Show error state\n  if (error) {\n    return (\n      <div className=\"text-center py-8\">\n        <div className=\"bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-4 max-w-md mx-auto\">\n          <p className=\"text-red-600 dark:text-red-200 font-medium mb-2\">Failed to load news</p>\n          <p className=\"text-red-500 dark:text-red-300 text-sm mb-3\">{error}</p>\n          <button\n            onClick={() => window.location.reload()}\n            className=\"px-3 py-1.5 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 transition-colors text-sm\"\n          >\n            Try Again\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Show empty state\n  if (filteredNews.length === 0) {\n    return (\n      <div className=\"text-center py-8\">\n        <div className=\"bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-4 max-w-md mx-auto\">\n          <p className=\"text-gray-500 dark:text-gray-300 font-medium\">No news available</p>\n          <p className=\"text-gray-400 dark:text-gray-500 text-sm mt-1\">Check back later for updates</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\" onClick={handleClickOutside}>\n      {filteredNews.map((item, index) => (\n        <article\n          key={item.id}\n          className=\"group bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-100 dark:border-gray-800 hover:shadow-md hover:border-gray-200 dark:hover:border-gray-700 transition-all duration-300\"\n        >\n          {/* Image */}\n          <div className=\"relative h-40 overflow-hidden\">\n            <img\n              src={item.image_url}\n              alt={item.title}\n              className=\"w-full h-full object-cover transition-transform duration-300 scale-110 md:scale-100\"\n            />\n            <div className=\"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent\" />\n          </div>\n\n          {/* Content */}\n          <div className=\"p-2 space-y-1.5\">\n            {/* Title with Menu */}\n            <div className=\"flex justify-between items-start gap-2\">\n              <h3 className=\"font-semibold text-gray-900 dark:text-gray-100 leading-tight line-clamp-2 text-sm flex-1\">\n                {item.title}\n              </h3>\n              <div className=\"relative\">\n                <button \n                  onClick={(e) => handleMenuClick(e, index)}\n                  className=\"text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors p-2\"\n                >\n                  <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path d=\"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z\" />\n                  </svg>\n                </button>\n                \n                {/* Dropdown Menu */}\n                {showMenu === index && (\n                  <div className=\"absolute right-0 top-6 z-20 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg min-w-[140px]\">\n                    <button\n                      onClick={(e) => handleViewSource(e, item)}\n                      className=\"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center gap-2\"\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" />\n                      </svg>\n                      View Source\n                    </button>\n                    <button\n                      onClick={(e) => handleShare(e, item)}\n                      className=\"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-t border-gray-100 dark:border-gray-800 flex items-center gap-2\"\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z\" />\n                      </svg>\n                      Share\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Meta + Read full article */}\n            <div className=\"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mt-2\">\n              <div className=\"flex items-center gap-1.5\">\n                <span>gsu.edu.ph</span>\n                <span>•</span>\n                <span>{formatDate(item.published_at)}</span>\n              </div>\n              {item.source_url && (\n                <a\n                  href={item.source_url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"inline-flex items-center gap-1 px-2 py-1 rounded-md border border-transparent text-xs font-medium text-gray-600 dark:text-gray-300 underline decoration-black/70 dark:decoration-white/70 underline-offset-2 hover:decoration-2 transition-colors\"\n                >\n                  Read full article\n                  <svg className=\"w-3 h-3 ml-1\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M17 8l4 4m0 0l-4 4m4-4H3\" />\n                  </svg>\n                </a>\n              )}\n            </div>\n          </div>\n        </article>\n      ))}\n    </div>\n  );\n} ","import { useState, useEffect, useRef } from \"react\";\nimport type { NewsItem } from \"../../types/news\";\n\ninterface CstNewsCardProps {\n  news: NewsItem;\n  isImageLoaded?: boolean;\n  index: number;\n  onImageLoaded: (index: number) => void;\n  canLoad: boolean;\n}\n\nexport default function CstNewsCard({ news, isImageLoaded = false, index, onImageLoaded, canLoad }: CstNewsCardProps) {\n  const [imageLoading, setImageLoading] = useState(!isImageLoaded);\n  const [isVisible, setIsVisible] = useState(false);\n  const [loadAttempted, setLoadAttempted] = useState(false);\n  const [retryCount, setRetryCount] = useState(0);\n  const [isMobile, setIsMobile] = useState(false);\n  const [showMenu, setShowMenu] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n  const imageRef = useRef<HTMLImageElement>(null);\n  const retryTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setShowMenu(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Detect mobile device\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent));\n    };\n    checkMobile();\n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // Start loading when canLoad becomes true\n  useEffect(() => {\n    if (canLoad && !isVisible) {\n      setIsVisible(true);\n      setLoadAttempted(true);\n    }\n  }, [canLoad, isVisible]);\n\n  // Setup intersection observer with mobile-specific settings\n  useEffect(() => {\n    observerRef.current = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting && canLoad) {\n            setIsVisible(true);\n            setLoadAttempted(true);\n          }\n        });\n      },\n      {\n        root: null,\n        rootMargin: isMobile ? '300px 0px' : '1500px 0px',\n        threshold: isMobile ? 0.1 : 0\n      }\n    );\n\n    if (containerRef.current) {\n      observerRef.current.observe(containerRef.current);\n    }\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, [canLoad, isMobile]);\n\n  // Force load after a delay if not loaded\n  useEffect(() => {\n    if (canLoad && !loadAttempted) {\n      const timer = setTimeout(() => {\n        if (!loadAttempted) {\n          setIsVisible(true);\n          setLoadAttempted(true);\n        }\n      }, isMobile ? 100 : 500);\n\n      return () => clearTimeout(timer);\n    }\n  }, [canLoad, loadAttempted, isMobile]);\n\n  // Cleanup retry timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (retryTimeoutRef.current) {\n        clearTimeout(retryTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const handleImageError = () => {\n    if (retryCount < 3) { // Reduced retry attempts\n      setRetryCount(prev => prev + 1);\n      setImageLoading(true);\n      \n      // Clear any existing retry timeout\n      if (retryTimeoutRef.current) {\n        clearTimeout(retryTimeoutRef.current);\n      }\n\n      // Force reload with exponential backoff\n      retryTimeoutRef.current = setTimeout(() => {\n        if (imageRef.current && news.image_url) {\n          const timestamp = Date.now();\n          const separator = news.image_url.includes('?') ? '&' : '?';\n          imageRef.current.src = `${news.image_url}${separator}t=${timestamp}`;\n        }\n      }, Math.min(1000 * Math.pow(2, retryCount), 5000)); // Exponential backoff with max 5s\n    } else {\n      // After max retries, show a fallback or error state\n      setImageLoading(false);\n      onImageLoaded(index);\n    }\n  };\n\n  const handleImageLoad = () => {\n    setImageLoading(false);\n    setLoadAttempted(true);\n    onImageLoaded(index);\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n  };\n\n  const handleMenuClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    setShowMenu(!showMenu);\n  };\n\n  const handleViewSource = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (news.source_url) {\n      window.open(news.source_url, '_blank', 'noopener,noreferrer');\n    }\n    setShowMenu(false);\n  };\n\n  const handleShare = async (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: news.title,\n          text: news.content.substring(0, 100),\n          url: news.source_url || window.location.href,\n        });\n      } catch (error) {\n        console.log('Share cancelled or failed');\n      }\n    } else {\n      // Fallback: copy to clipboard\n      const shareText = `${news.title}\\n\\n${news.content.substring(0, 100)}...\\n\\nRead more: ${news.source_url || window.location.href}`;\n      try {\n        await navigator.clipboard.writeText(shareText);\n        // You could add a toast notification here\n        console.log('Content copied to clipboard');\n      } catch (error) {\n        console.error('Failed to copy to clipboard');\n      }\n    }\n    setShowMenu(false);\n  };\n\n  return (\n    <div \n      className=\"block relative h-full\"\n    >\n      <div ref={containerRef} className=\"relative h-full overflow-hidden rounded-lg bg-white dark:bg-gray-900 shadow-sm border border-gray-200 dark:border-gray-700\">\n        <div className=\"flex h-full\">\n          {/* Left side - Image (wider) */}\n          <div className=\"w-[53%] h-full relative\">\n            {imageLoading && (\n              <div className=\"w-full h-full bg-gray-100 dark:bg-gray-800 animate-pulse\" />\n            )}\n            {isVisible && (\n              <img\n                ref={imageRef}\n                src={news.image_url}\n                alt={news.title}\n                className={`w-full h-full object-cover ${\n                  imageLoading ? 'hidden' : 'block'\n                }`}\n                onLoad={handleImageLoad}\n                onError={handleImageError}\n                loading={isMobile ? \"eager\" : \"lazy\"}\n                decoding={isMobile ? \"async\" : \"auto\"}\n              />\n            )}\n          </div>\n\n          {/* Right side - Content */}\n          <div className=\"w-[47%] h-full flex flex-col p-3\">\n            {/* CST Badge at top of title */}\n            <div className=\"mb-1 flex justify-between items-center relative\">\n              <span className=\"text-xs font-medium text-gray-500 dark:text-gray-300 underline underline-offset-2\">\n                CST\n              </span>\n              <div ref={menuRef} className=\"relative\">\n                <button \n                  onClick={handleMenuClick}\n                  className=\"text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors p-2\"\n                >\n                  <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path d=\"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z\" />\n                  </svg>\n                </button>\n                \n                {/* Dropdown Menu */}\n                {showMenu && (\n                  <div className=\"absolute right-0 top-6 z-20 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg min-w-[140px]\">\n                    <button\n                      onClick={handleViewSource}\n                      className=\"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center gap-2\"\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" />\n                      </svg>\n                      View Source\n                    </button>\n                    <button\n                      onClick={handleShare}\n                      className=\"w-full text-left px-3 py-2 text-xs text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-t border-gray-100 dark:border-gray-800 flex items-center gap-2\"\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z\" />\n                      </svg>\n                      Share\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n            \n            {/* Title and Content - Flexible area */}\n            <div className=\"flex-1 min-h-0 space-y-3 overflow-hidden\">\n              <h3\n                className=\"text-xs font-semibold text-gray-900 dark:text-gray-100 leading-tight line-clamp-4 underline decoration-gray-400 dark:decoration-gray-500 underline-offset-2 cursor-pointer hover:decoration-2 transition\"\n                onClick={() => {\n                  if (news.source_url) {\n                    window.open(news.source_url, '_blank', 'noopener,noreferrer');\n                  }\n                }}\n                tabIndex={0}\n                role=\"link\"\n                aria-label=\"Read full article\"\n              >\n                {news.title}\n              </h3>\n              <p className=\"text-xs text-gray-600 dark:text-gray-300 leading-relaxed line-clamp-5\">\n                {news.content}\n              </p>\n            </div>\n\n            {/* Date and source - Fixed at bottom */}\n            <div className=\"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400 pt-2 border-t border-gray-100 dark:border-gray-800 flex-shrink-0\">\n              <span className=\"truncate\">\n                {news.source_url ? new URL(news.source_url).hostname.replace('www.', '') : 'GSU'}\n              </span>\n              <span>•</span>\n              <span className=\"whitespace-nowrap\">{formatDate(news.published_at)}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n} ","import { useState } from \"react\";\nimport type { NewsItem } from \"../../types/news\";\nimport CstNewsCard from \"./CstNewsCard\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface CstNewsProps {\n  news: NewsItem[];\n  loading: boolean;\n  error: string | null;\n}\n\n// Function to preload images\nconst preloadImages = async (news: NewsItem[]): Promise<Set<string>> => {\n  const preloadedUrls = new Set<string>();\n  \n  await Promise.all(\n    news\n      .filter((item: NewsItem) => item.image_url)\n      .map(async (item: NewsItem) => {\n        const url = item.image_url as string;\n        try {\n          const img = new Image();\n          await new Promise((resolve, reject) => {\n            img.onload = resolve;\n            img.onerror = reject;\n            img.src = url;\n          });\n          preloadedUrls.add(url);\n        } catch (error) {\n          console.warn(`Failed to preload image: ${url}`, error);\n        }\n      })\n  );\n  \n  return preloadedUrls;\n};\n\nexport default function CstNews({ news, loading, error }: CstNewsProps) {\n  const [loadedIndices, setLoadedIndices] = useState<Set<number>>(new Set());\n  const [nextToLoad, setNextToLoad] = useState(0);\n\n  // Use React Query to cache preloaded images\n  const { data: preloadedImages = new Set<string>() } = useQuery<Set<string>>({\n    queryKey: ['cstPreloadedImages', news.map(item => item.id).join(',')],\n    queryFn: () => preloadImages(news),\n    enabled: news.length > 0,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 30 * 60 * 1000, // 30 minutes\n  });\n\n  const handleImageLoaded = (index: number) => {\n    setLoadedIndices(prev => new Set([...prev, index]));\n    setNextToLoad(prev => prev + 1);\n  };\n\n  const checkImageLoaded = (news: NewsItem) => {\n    return news.image_url ? preloadedImages.has(news.image_url) : false;\n  };\n\n  const canLoadImage = (index: number) => {\n    return Math.abs(index - nextToLoad) <= 3 || loadedIndices.has(index - 1) || index < 4;\n  };\n\n  // Only show loading state on initial load\n  if (loading && (!news || news.length === 0)) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {[...Array(6)].map((_, index) => (\n          <div key={index} className=\"aspect-[4/3]\">\n            <div className=\"w-full h-full bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden\">\n              {/* Image skeleton */}\n              <div className=\"w-full h-[60%] bg-gray-100 dark:bg-gray-800 animate-pulse\" />\n              \n              {/* Content skeleton */}\n              <div className=\"p-4 space-y-3\">\n                {/* Title skeleton */}\n                <div className=\"h-4 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-3/4\" />\n                \n                {/* Date skeleton */}\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-24\" />\n                  <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-16\" />\n                </div>\n                \n                {/* Description skeleton */}\n                <div className=\"space-y-2\">\n                  <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-full\" />\n                  <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-5/6\" />\n                  <div className=\"h-3 bg-gray-100 dark:bg-gray-800 animate-pulse rounded w-4/6\" />\n                </div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-red-500 dark:text-red-300\">{error}</p>\n      </div>\n    );\n  }\n\n  if (!news || news.length === 0) {\n    return (\n      <div className=\"text-center py-8\">\n        <p className=\"text-gray-500 dark:text-gray-300\">No news available for CST</p>\n      </div>\n    );\n  }\n\n  // Sort news by published_at date and take only the 10 most recent\n  const recentNews = [...news]\n    .sort((a, b) => new Date(b.published_at).getTime() - new Date(a.published_at).getTime())\n    .slice(0, 10);\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n      {recentNews.map((item: NewsItem, index: number) => (\n        <div key={item.id} className=\"aspect-[4/3]\">\n          <CstNewsCard \n            news={item}\n            isImageLoaded={checkImageLoaded(item)}\n            index={index}\n            onImageLoaded={handleImageLoaded}\n            canLoad={canLoadImage(index)}\n          />\n        </div>\n      ))}\n    </div>\n  );\n} ","import { useQuery } from \"@tanstack/react-query\";\nimport { getNews } from \"@/services/newsService\";\nimport type { NewsItem } from \"@/types/news\";\nimport MainCampusNews from \"@/components/news/MainCampusNews\";\nimport CstNews from \"@/components/news/CstNews\";\nimport { motion, useInView } from \"framer-motion\";\nimport { Link } from \"react-router-dom\";\nimport { ArrowRight } from \"lucide-react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { ArrowUpIcon } from '@heroicons/react/24/outline';\n\nfunction AnimatedSectionHeader({ children, revealOnScroll = false }: { children: string, revealOnScroll?: boolean }) {\n  const textRef = useRef<HTMLHeadingElement>(null);\n  const [textWidth, setTextWidth] = useState(0);\n\n  useEffect(() => {\n    if (textRef.current) {\n      setTextWidth(textRef.current.offsetWidth);\n    }\n  }, [children]);\n\n  // For reveal on scroll\n  const inViewRef = useRef<HTMLDivElement>(null);\n  const isInView = useInView(inViewRef, { once: true, margin: '0px 0px -20% 0px' });\n\n  const fadeProps = revealOnScroll\n    ? {\n        initial: { opacity: 0 },\n        animate: isInView ? { opacity: 1 } : { opacity: 0 },\n        transition: { duration: 1 },\n      }\n    : {\n        initial: { opacity: 0 },\n        animate: { opacity: 1 },\n        transition: { duration: 1, delay: 0.1 },\n      };\n\n  const lineProps = revealOnScroll\n    ? {\n        initial: { opacity: 0, width: 24 },\n        animate: isInView ? { opacity: 1, width: textWidth || 64 } : { opacity: 0, width: 24 },\n        transition: { duration: 1, delay: 0.15 },\n      }\n    : {\n        initial: { opacity: 0, width: 24 },\n        animate: { opacity: 1, width: textWidth || 64 },\n        transition: { duration: 1, delay: 0.25 },\n      };\n\n  return (\n    <div className=\"relative inline-block\" ref={revealOnScroll ? inViewRef : undefined}>\n      <motion.h2\n        ref={textRef}\n        className=\"text-lg font-bold text-gray-900 dark:text-gray-100 inline-block pb-1\"\n        {...fadeProps}\n      >\n        {children}\n      </motion.h2>\n      <motion.span\n        className=\"block absolute left-0 -bottom-0.5 h-0.5 bg-black dark:bg-white rounded-full\"\n        {...lineProps}\n        aria-hidden=\"true\"\n        style={{ maxWidth: '100%' }}\n      />\n    </div>\n  );\n}\n\nfunction AnimatedSeparator() {\n  const ref = useRef<HTMLDivElement>(null);\n  const isInView = useInView(ref, { once: true, margin: '0px 0px -20% 0px' });\n  return (\n    <div className=\"flex justify-center\">\n      <motion.div\n        ref={ref}\n        className=\"h-0.5 bg-black dark:bg-white rounded-full\"\n        initial={{ scaleX: 0 }}\n        animate={isInView ? { scaleX: 1 } : { scaleX: 0 }}\n        transition={{ duration: 0.7, delay: 0.1 }}\n        style={{ width: '100%', maxWidth: 480, transformOrigin: 'center' }}\n        aria-hidden=\"true\"\n      />\n    </div>\n  );\n}\n\nexport default function Home() {\n  const { data: news = [], isLoading, error } = useQuery<NewsItem[]>({\n    queryKey: ['news'],\n    queryFn: async () => {\n        const { data, error } = await getNews();\n      if (error) throw new Error('Failed to load news');\n      return data;\n    },\n    staleTime: 60 * 60 * 1000, // 1 hour\n    gcTime: 2 * 60 * 60 * 1000, // 2 hours\n    refetchOnWindowFocus: false,\n    retry: 1,\n  });\n\n  const [showScrollTop, setShowScrollTop] = useState(false);\n\n  useEffect(() => {\n    const handleScroll = () => {\n      setShowScrollTop(window.scrollY > 200);\n    };\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  const handleScrollToTop = () => {\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n  };\n\n  const mainCampusNews = news.filter(item => item.campus?.name === \"Main Campus\");\n  const cstNews = news.filter(item => item.campus?.name === \"CST\");\n  const errorMessage = error instanceof Error ? error.message : null;\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100\">\n      {/* Hero Section */}\n      <section className=\"relative pt-10 pb-3 px-4\">\n        <div className=\"max-w-5xl mx-auto\">\n          <div className=\"text-center\">\n            <motion.h1\n              className=\"text-4xl md:text-5xl font-bold tracking-tight text-gray-900 dark:text-gray-100 mb-4\"\n              initial={{ opacity: 0, y: 32 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.7, delay: 0.1, ease: 'easeOut' }}\n            >\n              What's News\n            </motion.h1>\n            <motion.p\n              className=\"text-xs text-gray-600 dark:text-gray-300 max-w-2xl mx-auto leading-relaxed mb-2\"\n              initial={{ opacity: 0, y: 32 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.7, delay: 0.4, ease: 'easeOut' }}\n            >\n              Stay connected. Stay informed\n            </motion.p>\n          </div>\n        </div>\n      </section>\n\n      {/* View All News Card */}\n      <div className=\"flex justify-center mb-2\">\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95, y: 8 }}\n          animate={{ opacity: 1, scale: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 1, ease: 'easeOut' }}\n        >\n          <Link\n            to=\"/news\"\n            className=\"group inline-flex items-center rounded-lg border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-950 shadow-sm hover:shadow transition-all duration-200 px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-primary\"\n            aria-label=\"View all news\"\n            style={{ minWidth: 0 }}\n          >\n            <span className=\"text-xs font-normal text-gray-900 dark:text-gray-100 whitespace-nowrap\">View all news</span>\n            <motion.span\n              className=\"inline-flex ml-1\"\n              initial={{ opacity: 1 }}\n              animate={{ opacity: [1, 0.3, 1] }}\n              transition={{ repeat: Infinity, duration: 1.2, ease: 'easeInOut' }}\n            >\n              <ArrowRight className=\"w-4 h-4 text-primary group-hover:translate-x-1 transition-transform duration-200\" />\n            </motion.span>\n          </Link>\n        </motion.div>\n      </div>\n\n      {/* Content Section */}\n      <section className=\"flex-1 overflow-y-auto px-4 py-8\">\n        <div className=\"max-w-6xl mx-auto space-y-12\">\n          {/* Main Campus Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <AnimatedSectionHeader>Salvador</AnimatedSectionHeader>\n              <Link\n                to=\"/news?campus=Main%20Campus\"\n                className=\"inline-flex items-center gap-1 text-xs text-primary underline underline-offset-4 decoration-1 hover:decoration-2 transition-colors focus:outline-none focus:ring-2 focus:ring-primary\"\n              >\n                Show all\n                <ArrowRight className=\"w-3 h-3\" />\n              </Link>\n            </div>\n            <MainCampusNews news={mainCampusNews} loading={isLoading} error={errorMessage} />\n          </div>\n\n          <AnimatedSeparator />\n\n          {/* CST Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <AnimatedSectionHeader revealOnScroll>Mosqueda</AnimatedSectionHeader>\n              <Link\n                to=\"/news?campus=CST\"\n                className=\"inline-flex items-center gap-1 text-xs text-primary underline underline-offset-4 decoration-1 hover:decoration-2 transition-colors focus:outline-none focus:ring-2 focus:ring-primary\"\n              >\n                Show all\n                <ArrowRight className=\"w-3 h-3\" />\n              </Link>\n            </div>\n            <CstNews news={cstNews} loading={isLoading} error={errorMessage} />\n          </div>\n        </div>\n      </section>\n\n      {/* Floating Scroll to Top Button (fixed to viewport) */}\n      {showScrollTop && (\n        <button\n          onClick={handleScrollToTop}\n          className=\"fixed bottom-6 right-6 z-50 p-3 rounded-full bg-gray-900 text-white dark:bg-gray-100 dark:text-gray-900 shadow-lg hover:bg-gray-700 dark:hover:bg-gray-200 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary\"\n          aria-label=\"Scroll to top\"\n        >\n          <ArrowUpIcon className=\"w-5 h-5\" />\n        </button>\n      )}\n    </div>\n  );\n} \n"],"names":["MainCampusNews","news","loading","error","showMenu","setShowMenu","useState","filteredNews","item","a","b","formatDate","dateString","handleMenuClick","e","index","handleViewSource","handleShare","shareText","handleClickOutside","jsx","_","jsxs","motion","CstNewsCard","isImageLoaded","onImageLoaded","canLoad","imageLoading","setImageLoading","isVisible","setIsVisible","loadAttempted","setLoadAttempted","retryCount","setRetryCount","isMobile","setIsMobile","containerRef","useRef","observerRef","imageRef","retryTimeoutRef","menuRef","useEffect","event","checkMobile","entries","entry","timer","handleImageError","prev","timestamp","separator","handleImageLoad","preloadImages","preloadedUrls","url","img","resolve","reject","CstNews","loadedIndices","setLoadedIndices","nextToLoad","setNextToLoad","preloadedImages","useQuery","handleImageLoaded","checkImageLoaded","canLoadImage","recentNews","AnimatedSectionHeader","children","revealOnScroll","textRef","textWidth","setTextWidth","inViewRef","isInView","useInView","fadeProps","lineProps","AnimatedSeparator","ref","Home","isLoading","data","getNews","showScrollTop","setShowScrollTop","handleScroll","handleScrollToTop","mainCampusNews","_a","cstNews","errorMessage","Link","ArrowRight","ArrowUpIcon"],"mappings":"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"}